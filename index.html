<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Power Platform Comprehensive Analysis Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e'
                        },
                        accent: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75'
                        },
                        success: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d'
                        },
                        warning: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f'
                        }
                    },
                    backgroundImage: {
                        'gradient-primary': 'linear-gradient(135deg, #0ea5e9 0%, #d946ef 100%)',
                        'gradient-card': 'linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)',
                        'gradient-card-dark': 'linear-gradient(135deg, #1e293b 0%, #334155 100%)',
                        'gradient-success': 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',
                        'gradient-warning': 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',
                        'gradient-info': 'linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%)',
                        'gradient-accent': 'linear-gradient(135deg, #d946ef 0%, #c026d3 100%)'
                    },
                    boxShadow: {
                        'card': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                        'card-hover': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                        'xl-colored': '0 20px 25px -5px rgba(14, 165, 233, 0.1), 0 10px 10px -5px rgba(14, 165, 233, 0.04)'
                    }
                }
            }
        }
    </script>
    <style>
        [x-cloak] { display: none !important; }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    <div x-data="powerPlatformTool()" x-cloak>
        <!-- Header -->
        <header class="bg-gradient-primary text-white shadow-xl-colored sticky top-0 z-50">
            <div class="container mx-auto px-4 py-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-bold bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent">Power Platform Analysis Tool</h1>
                        <p class="text-white/80 text-sm font-medium">Comprehensive Feature, Security & Licensing Breakdown</p>
                    </div>

                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm border-b border-gray-200/50 dark:border-gray-700/50 sticky top-20 z-40">
            <div class="container mx-auto px-4">
                <div class="flex flex-wrap gap-2 py-2 justify-center md:justify-start">
                    <template x-for="(section, key) in sections" :key="key">
                        <button 
                            @click="activeSection = key"
                            :class="activeSection === key ? 'bg-gradient-primary text-white shadow-card' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:shadow-card'"
                            class="px-4 py-2 md:px-6 md:py-3 rounded-xl text-xs md:text-sm font-medium transition-all duration-300 flex items-center space-x-1 md:space-x-2 min-w-fit">
                            <span x-text="section.icon" class="text-base md:text-lg"></span>
                            <span x-text="section.name" class="hidden sm:inline"></span>
                        </button>
                    </template>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="container mx-auto px-4 py-8">
            <!-- Product Features Section -->
            <div x-show="activeSection === 'features'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">üîç Microsoft Power Platform: Expert-Level Feature Guide</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-4xl mx-auto mb-6">
                        The Microsoft Power Platform is a low-code/no-code suite empowering organizations to digitize processes, build apps, analyze data, and automate workflows. Built to integrate with Microsoft 365, Azure, and hundreds of external systems, the platform enables users of all skill levels to innovate at scale.
                    </p>
                    
                    <!-- Core Platform Overview -->
                    <div class="bg-gradient-primary p-6 rounded-2xl text-white mb-8">
                        <h3 class="text-xl font-bold mb-4">üåü Core Platform Components</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 text-sm">
                            <div class="bg-white/10 backdrop-blur-sm p-3 rounded-lg">
                                <div class="text-lg mb-1">üì±</div>
                                <div class="font-semibold">Power Apps</div>
                                <div class="text-white/80">Build custom apps rapidly</div>
                            </div>
                            <div class="bg-white/10 backdrop-blur-sm p-3 rounded-lg">
                                <div class="text-lg mb-1">‚ö°</div>
                                <div class="font-semibold">Power Automate</div>
                                <div class="text-white/80">Automate workflows & integrations</div>
                            </div>
                            <div class="bg-white/10 backdrop-blur-sm p-3 rounded-lg">
                                <div class="text-lg mb-1">üìä</div>
                                <div class="font-semibold">Power BI</div>
                                <div class="text-white/80">Visualize & analyze data</div>
                            </div>
                            <div class="bg-white/10 backdrop-blur-sm p-3 rounded-lg">
                                <div class="text-lg mb-1">üåê</div>
                                <div class="font-semibold">Power Pages</div>
                                <div class="text-white/80">Secure external websites</div>
                            </div>
                            <div class="bg-white/10 backdrop-blur-sm p-3 rounded-lg">
                                <div class="text-lg mb-1">ü§ñ</div>
                                <div class="font-semibold">Copilot Studio</div>
                                <div class="text-white/80">AI-driven chatbots</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Feature Filters -->
                <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-xl">
                    <h3 class="text-lg font-semibold mb-4">Filter Features</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Product</label>
                            <select x-model="filters.product" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                                <option value="">All Products</option>
                                <template x-for="product in Object.keys(productData)" :key="product">
                                    <option :value="product" x-text="productData[product].name"></option>
                                </template>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Category</label>
                            <select x-model="filters.category" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                                <option value="">All Categories</option>
                                <option value="core">Core Features</option>
                                <option value="integration">Integration</option>
                                <option value="security">Security</option>
                                <option value="ai">AI & Automation</option>
                                <option value="mobile">Mobile</option>
                                <option value="governance">Governance</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">License Level</label>
                            <select x-model="filters.license" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                                <option value="">All Licenses</option>
                                <option value="free">Free/M365 Included</option>
                                <option value="premium">Premium</option>
                                <option value="standalone">Standalone</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Product Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <template x-for="(product, key) in filteredProducts" :key="key">
                        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-card hover:shadow-card-hover transition-all duration-300 border border-gray-200 dark:border-gray-700 overflow-hidden">
                            <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-card dark:bg-gradient-card-dark">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h3 class="text-xl font-bold text-gray-800 dark:text-white" x-text="product.name"></h3>
                                        <p class="text-gray-600 dark:text-gray-300" x-text="product.description"></p>
                                    </div>
                                    <div class="text-3xl" x-text="product.icon"></div>
                                </div>
                            </div>
                            <div class="p-6">
                                <template x-for="(categoryFeatures, category) in product.features" :key="category">
                                    <div class="mb-6" x-show="!filters.category || filters.category === category">
                                        <h4 class="font-semibold text-lg mb-3 capitalize" x-text="category.replace('_', ' ')"></h4>
                                        <div class="space-y-2">
                                            <template x-for="feature in categoryFeatures" :key="feature.name">
                                                <div class="flex items-start space-x-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg" 
                                                     x-show="!filters.license || filters.license === feature.license">
                                                    <div class="flex-shrink-0 w-5 h-5 rounded-full flex items-center justify-center text-xs"
                                                         :class="feature.license === 'free' ? 'bg-green-100 text-green-800' : 
                                                                feature.license === 'premium' ? 'bg-blue-100 text-blue-800' : 
                                                                'bg-purple-100 text-purple-800'">
                                                        <span x-text="feature.license === 'free' ? 'F' : feature.license === 'premium' ? 'P' : 'S'"></span>
                                                    </div>
                                                    <div class="flex-1">
                                                        <h5 class="font-medium" x-text="feature.name"></h5>
                                                        <p class="text-sm text-gray-600 dark:text-gray-400" x-text="feature.description"></p>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>
                </div>
            </div>

            <!-- AI & Copilot Section -->
            <div x-show="activeSection === 'ai'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">ü§ñ AI Copilot Integration</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                        Integrated AI features across the platform enabling natural language app building, intelligent automation, and enhanced productivity.
                    </p>
                </div>

                <!-- AI Copilot Overview -->
                <div class="bg-gradient-accent p-8 rounded-2xl text-white">
                    <h3 class="text-2xl font-bold mb-6">‚ú® AI-First Platform Experience</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="bg-white/10 backdrop-blur-sm p-4 rounded-xl">
                            <div class="text-2xl mb-2">üì±</div>
                            <h4 class="font-semibold mb-2">Power Apps Copilot</h4>
                            <p class="text-white/80 text-sm">Describe app in natural language to build it. Generate formulas, create screens, and add functionality through conversation.</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-sm p-4 rounded-xl">
                            <div class="text-2xl mb-2">‚ö°</div>
                            <h4 class="font-semibold mb-2">Power Automate Copilot</h4>
                            <p class="text-white/80 text-sm">Generate flows from text descriptions. AI assists with flow creation, troubleshooting, and optimization.</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-sm p-4 rounded-xl">
                            <div class="text-2xl mb-2">üìä</div>
                            <h4 class="font-semibold mb-2">Power BI Copilot</h4>
                            <p class="text-white/80 text-sm">AI insights, Smart Narratives, and natural language Q&A for data analysis and report generation.</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-sm p-4 rounded-xl">
                            <div class="text-2xl mb-2">ü§ñ</div>
                            <h4 class="font-semibold mb-2">Copilot Studio</h4>
                            <p class="text-white/80 text-sm">Train chatbots via conversational input. Generative AI answers from knowledge bases.</p>
                        </div>
                    </div>
                </div>

                <!-- AI Builder Capabilities -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-card hover:shadow-card-hover transition-all duration-300 overflow-hidden">
                        <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-info text-white">
                            <h3 class="text-xl font-bold">üß† AI Builder Pre-built Models</h3>
                            <p class="text-white/80">Ready-to-use AI capabilities for common scenarios</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                                        <span class="text-blue-600 text-sm">üìÑ</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Form Processing</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Extract data from invoices, receipts, business cards, and forms</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                                        <span class="text-green-600 text-sm">üìù</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Text Analytics</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Sentiment analysis, language detection, and key phrase extraction</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                                        <span class="text-purple-600 text-sm">üëÅÔ∏è</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Object Detection</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Identify and count objects in images</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center">
                                        <span class="text-orange-600 text-sm">üîÆ</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Prediction Models</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Forecast outcomes based on historical data</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-card hover:shadow-card-hover transition-all duration-300 overflow-hidden">
                        <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-success text-white">
                            <h3 class="text-xl font-bold">üéØ Custom AI Models</h3>
                            <p class="text-white/80">Train AI models with your own data</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                                        <span class="text-blue-600 text-sm">üè∑Ô∏è</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Custom Form Processing</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Train models on your specific document types</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                                        <span class="text-green-600 text-sm">üìä</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Binary Classification</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Yes/No predictions based on your data</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                                        <span class="text-purple-600 text-sm">üéØ</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Category Classification</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Automatically categorize text into groups</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center">
                                        <span class="text-orange-600 text-sm">üé®</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Custom Object Detection</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Detect specific objects in your images</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Integration Examples -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                        <h3 class="text-xl font-bold">üí° Real-World AI Integration Examples</h3>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                <h4 class="font-semibold mb-2">üìã Invoice Processing</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400">AI Builder extracts data from invoices ‚Üí Power Automate validates and routes for approval ‚Üí Power BI tracks processing metrics</p>
                            </div>
                            <div class="p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                <h4 class="font-semibold mb-2">üéß Customer Service</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Copilot Studio chatbot handles initial queries ‚Üí Sentiment analysis prioritizes cases ‚Üí Power Apps escalates to human agents</p>
                            </div>
                            <div class="p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                                <h4 class="font-semibold mb-2">üìä Predictive Maintenance</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400">AI Builder predicts equipment failure ‚Üí Power Automate schedules maintenance ‚Üí Power BI tracks equipment health</p>
                            </div>
                            <div class="p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
                                <h4 class="font-semibold mb-2">üìÑ Document Classification</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400">AI Builder categorizes incoming documents ‚Üí Power Automate routes to correct department ‚Üí Power Apps tracks processing status</p>
                            </div>
                            <div class="p-4 bg-red-50 dark:bg-red-900/20 rounded-lg">
                                <h4 class="font-semibold mb-2">üõí Sales Forecasting</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400">AI Builder analyzes sales patterns ‚Üí Power BI displays predictions ‚Üí Power Apps alerts sales team of opportunities</p>
                            </div>
                            <div class="p-4 bg-teal-50 dark:bg-teal-900/20 rounded-lg">
                                <h4 class="font-semibold mb-2">üè≠ Quality Control</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400">AI Builder detects defects in product images ‚Üí Power Automate triggers quality alerts ‚Üí Power BI tracks quality metrics</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Builder vs Azure Form Recognizer Comparison -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20">
                        <h3 class="text-2xl font-bold">‚öñÔ∏è AI Builder vs Azure Form Recognizer Comparison</h3>
                        <p class="text-gray-600 dark:text-gray-400 mt-2">Choose the right document processing solution for your needs and budget</p>
                    </div>
                    <div class="p-8">
                        <!-- Overview Cards -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            <div class="bg-gradient-to-br from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-purple-200 dark:border-purple-700">
                                <div class="flex items-center mb-4">
                                    <span class="text-3xl mr-3">üü™</span>
                                    <div>
                                        <h4 class="text-xl font-bold text-purple-800 dark:text-purple-300">AI Builder (Power Platform)</h4>
                                        <p class="text-purple-600 dark:text-purple-400 text-sm">No-code document processing</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div>
                                        <h5 class="font-semibold mb-2">What It Does:</h5>
                                        <ul class="text-sm space-y-1">
                                            <li>‚Ä¢ Built into Power Automate and Power Apps</li>
                                            <li>‚Ä¢ Document processing with prebuilt models</li>
                                            <li>‚Ä¢ Extract values and classify documents</li>
                                            <li>‚Ä¢ Analyze images and text</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h5 class="font-semibold mb-2">Pricing:</h5>
                                        <div class="bg-white dark:bg-gray-800 p-3 rounded">
                                            <p class="text-sm font-medium">$500 per 1 million credits</p>
                                            <p class="text-xs text-gray-600 dark:text-gray-400">~5 credits per page = $0.0025/page</p>
                                            <p class="text-xs text-green-600 font-medium">5,000 credits/month included with licenses</p>
                                        </div>
                                    </div>
                                    <div>
                                        <h5 class="font-semibold mb-2">Best For:</h5>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Power Platform users, quick forms, integrated workflows</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-700">
                                <div class="flex items-center mb-4">
                                    <span class="text-3xl mr-3">üü¶</span>
                                    <div>
                                        <h4 class="text-xl font-bold text-blue-800 dark:text-blue-300">Azure Form Recognizer</h4>
                                        <p class="text-blue-600 dark:text-blue-400 text-sm">Azure AI Document Intelligence</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div>
                                        <h5 class="font-semibold mb-2">What It Does:</h5>
                                        <ul class="text-sm space-y-1">
                                            <li>‚Ä¢ Extract text, tables, key-value pairs, layout</li>
                                            <li>‚Ä¢ Prebuilt models (invoices, receipts, IDs)</li>
                                            <li>‚Ä¢ Custom model training</li>
                                            <li>‚Ä¢ Document classification</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h5 class="font-semibold mb-2">Pricing:</h5>
                                        <div class="bg-white dark:bg-gray-800 p-3 rounded">
                                            <p class="text-sm font-medium">$0.01 per page</p>
                                            <p class="text-xs text-gray-600 dark:text-gray-400">Document Classification: $0.002/page</p>
                                            <p class="text-xs text-gray-600 dark:text-gray-400">Custom training: Free</p>
                                        </div>
                                    </div>
                                    <div>
                                        <h5 class="font-semibold mb-2">Best For:</h5>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">High-scale processing, custom ML, advanced layouts</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Detailed Comparison Table -->
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-xl overflow-hidden mb-8">
                            <div class="p-6 border-b border-gray-200 dark:border-gray-600">
                                <h4 class="text-lg font-bold">üìä Feature Comparison</h4>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-100 dark:bg-gray-600">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-sm font-semibold">Feature</th>
                                            <th class="px-6 py-3 text-center text-sm font-semibold">üü™ AI Builder</th>
                                            <th class="px-6 py-3 text-center text-sm font-semibold">üü¶ Azure Form Recognizer</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-200 dark:divide-gray-600">
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-6 py-4 font-medium">Ease of Use</td>
                                            <td class="px-6 py-4 text-center text-green-600">No-code (Power Apps/Automate)</td>
                                            <td class="px-6 py-4 text-center text-orange-600">Dev-oriented (API or Logic Apps)</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-6 py-4 font-medium">Price per Page</td>
                                            <td class="px-6 py-4 text-center text-green-600">~$0.0025</td>
                                            <td class="px-6 py-4 text-center text-red-600">$0.01</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-6 py-4 font-medium">Model Types</td>
                                            <td class="px-6 py-4 text-center">Prebuilt, Custom (structured forms)</td>
                                            <td class="px-6 py-4 text-center text-green-600">Prebuilt, Custom, Classification, Layout</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-6 py-4 font-medium">Setup Time</td>
                                            <td class="px-6 py-4 text-center text-green-600">Very fast (drag-and-drop)</td>
                                            <td class="px-6 py-4 text-center text-orange-600">Moderate (Azure setup + REST calls)</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-6 py-4 font-medium">Output Format</td>
                                            <td class="px-6 py-4 text-center">Key fields only (Power FX-compatible)</td>
                                            <td class="px-6 py-4 text-center text-green-600">Full JSON with layout, tables, etc.</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-6 py-4 font-medium">Integration with Power Platform</td>
                                            <td class="px-6 py-4 text-center text-green-600">Native</td>
                                            <td class="px-6 py-4 text-center text-orange-600">Requires connector or Logic Apps</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Cost Calculator -->
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 p-6 rounded-xl" x-data="{ monthlyPages: 1000 }">
                            <h4 class="text-xl font-bold mb-4 text-center">üí∞ Cost Calculator</h4>
                            <div class="max-w-md mx-auto mb-6">
                                <label class="block text-sm font-medium mb-2">Monthly Pages to Process:</label>
                                <input type="number" x-model.number="monthlyPages" min="1" max="1000000" 
                                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base text-center font-bold">
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg text-center">
                                    <h5 class="font-semibold text-purple-600 mb-3">üü™ AI Builder Cost</h5>
                                    <div class="space-y-2">
                                        <div x-show="monthlyPages * 5 <= 5000" class="text-2xl font-bold text-green-600">
                                            FREE
                                        </div>
                                        <div x-show="monthlyPages * 5 > 5000" class="text-2xl font-bold text-purple-600">
                                            $<span x-text="Math.ceil((monthlyPages * 5 - 5000) / 1000000 * 500)"></span>
                                        </div>
                                        <p class="text-xs text-gray-500">
                                            <span x-text="monthlyPages * 5"></span> credits needed
                                            <span x-show="monthlyPages * 5 <= 5000">(covered by license)</span>
                                        </p>
                                    </div>
                                </div>
                                
                                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg text-center">
                                    <h5 class="font-semibold text-blue-600 mb-3">üü¶ Azure Form Recognizer Cost</h5>
                                    <div class="space-y-2">
                                        <div class="text-2xl font-bold text-blue-600">
                                            $<span x-text="(monthlyPages * 0.01).toFixed(0)"></span>
                                        </div>
                                        <p class="text-xs text-gray-500">
                                            $0.01 √ó <span x-text="monthlyPages.toLocaleString()"></span> pages
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg text-center">
                                <div x-show="monthlyPages * 5 <= 5000">
                                    <p class="text-green-600 font-semibold">‚úÖ AI Builder is FREE at this volume (covered by license)</p>
                                </div>
                                <div x-show="monthlyPages * 5 > 5000 && (monthlyPages * 0.0025) < (monthlyPages * 0.01)">
                                    <p class="text-purple-600 font-semibold">üü™ AI Builder is cheaper: $<span x-text="Math.ceil((monthlyPages * 5 - 5000) / 1000000 * 500)"></span> vs $<span x-text="(monthlyPages * 0.01).toFixed(0)"></span></p>
                                </div>
                                <div x-show="monthlyPages * 5 > 5000 && (monthlyPages * 0.0025) >= (monthlyPages * 0.01)">
                                    <p class="text-blue-600 font-semibold">üü¶ Azure Form Recognizer is cheaper: $<span x-text="(monthlyPages * 0.01).toFixed(0)"></span> vs $<span x-text="Math.ceil((monthlyPages * 5 - 5000) / 1000000 * 500)"></span></p>
                                </div>
                            </div>
                        </div>

                        <!-- Decision Matrix -->
                        <div class="mt-8 bg-gray-50 dark:bg-gray-700 rounded-xl p-6">
                            <h4 class="text-xl font-bold mb-6 text-center">üß† Which One Should You Use?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h5 class="font-semibold text-purple-600 mb-3">Choose AI Builder When:</h5>
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Already using Power Automate / Power Apps</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Processing < 1,000 pages/month</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Need quick classification and field extraction</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Prefer no-code UI with SharePoint / Excel</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Want seamless integration with M365</span>
                                        </li>
                                    </ul>
                                </div>
                                
                                <div>
                                    <h5 class="font-semibold text-blue-600 mb-3">Choose Azure Form Recognizer When:</h5>
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Processing 10,000+ pages/month</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Want full control over layout/tables</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Need advanced document logic with custom models</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Have development resources available</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-green-500 mt-1">‚úÖ</span>
                                            <span>Need detailed JSON output with positioning</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Real Example Scenarios -->
                        <div class="mt-8 grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg">
                                <h5 class="font-semibold text-green-800 dark:text-green-300 mb-2">100 pages/month</h5>
                                <div class="space-y-1 text-sm">
                                    <p><strong>AI Builder:</strong> FREE (covered by license)</p>
                                    <p><strong>Azure:</strong> $1/month</p>
                                    <p class="text-green-600 font-medium">‚úÖ AI Builder wins</p>
                                </div>
                            </div>
                            
                            <div class="bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg">
                                <h5 class="font-semibold text-yellow-800 dark:text-yellow-300 mb-2">10,000 pages/month</h5>
                                <div class="space-y-1 text-sm">
                                    <p><strong>AI Builder:</strong> ~$25/month</p>
                                    <p><strong>Azure:</strong> $100/month</p>
                                    <p class="text-purple-600 font-medium">üü™ AI Builder wins</p>
                                </div>
                            </div>
                            
                            <div class="bg-red-50 dark:bg-red-900/20 p-4 rounded-lg">
                                <h5 class="font-semibold text-red-800 dark:text-red-300 mb-2">100,000 pages/month</h5>
                                <div class="space-y-1 text-sm">
                                    <p><strong>AI Builder:</strong> ~$250/month</p>
                                    <p><strong>Azure:</strong> $1,000/month</p>
                                    <p class="text-purple-600 font-medium">üü™ AI Builder wins</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Task vs Process Mining Section -->
            <div x-show="activeSection === 'mining'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">‚õèÔ∏è Task Mining vs Process Mining</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                        Understand the differences between Task Mining and Process Mining, and how they work together to optimize business operations.
                    </p>
                </div>

                <!-- Comparison Overview -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-card hover:shadow-card-hover transition-all duration-300 overflow-hidden">
                        <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-warning text-white">
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl">üëÅÔ∏è</span>
                                <div>
                                    <h3 class="text-xl font-bold">Task Mining</h3>
                                    <p class="text-white/80">User Desktop Interaction Analysis</p>
                                </div>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-lg mb-2">What it does:</h4>
                                    <p class="text-gray-600 dark:text-gray-400 mb-3">Records user interactions (clicks, scrolls, keystrokes) across desktop applications to discover tasks ripe for automation.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2">Key Features:</h4>
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex items-start space-x-2">
                                            <span class="text-orange-500 mt-1">‚Ä¢</span>
                                            <span>Desktop recording and screen capture</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-orange-500 mt-1">‚Ä¢</span>
                                            <span>Task pattern recognition</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-orange-500 mt-1">‚Ä¢</span>
                                            <span>User journey mapping</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-orange-500 mt-1">‚Ä¢</span>
                                            <span>Time and efficiency analysis</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-orange-500 mt-1">‚Ä¢</span>
                                            <span>RPA opportunity identification</span>
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2">Best For:</h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Individual user tasks, repetitive desktop work, manual data entry, document processing</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-card hover:shadow-card-hover transition-all duration-300 overflow-hidden">
                        <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-info text-white">
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl">‚õèÔ∏è</span>
                                <div>
                                    <h3 class="text-xl font-bold">Process Mining</h3>
                                    <p class="text-white/80">Business Process Discovery & Analysis</p>
                                </div>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-lg mb-2">What it does:</h4>
                                    <p class="text-gray-600 dark:text-gray-400 mb-3">Maps business process flows using system logs and telemetry to help with compliance and process redesign.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2">Key Features:</h4>
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex items-start space-x-2">
                                            <span class="text-blue-500 mt-1">‚Ä¢</span>
                                            <span>Process discovery from system logs</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-blue-500 mt-1">‚Ä¢</span>
                                            <span>End-to-end process visualization</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-blue-500 mt-1">‚Ä¢</span>
                                            <span>Bottleneck and deviation analysis</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-blue-500 mt-1">‚Ä¢</span>
                                            <span>Compliance monitoring</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-blue-500 mt-1">‚Ä¢</span>
                                            <span>Process performance metrics</span>
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2">Best For:</h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Enterprise processes, compliance auditing, process optimization, system integrations</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Comparison Table -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                        <h3 class="text-xl font-bold">üìä Side-by-Side Comparison</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">Aspect</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">üëÅÔ∏è Task Mining</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">‚õèÔ∏è Process Mining</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Data Source</td>
                                    <td class="px-6 py-4 text-center">User desktop interactions</td>
                                    <td class="px-6 py-4 text-center">System event logs</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Analysis Level</td>
                                    <td class="px-6 py-4 text-center">Individual tasks and activities</td>
                                    <td class="px-6 py-4 text-center">End-to-end business processes</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Primary Goal</td>
                                    <td class="px-6 py-4 text-center">Identify RPA opportunities</td>
                                    <td class="px-6 py-4 text-center">Process optimization & compliance</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Recording Method</td>
                                    <td class="px-6 py-4 text-center">Screen recording, click capture</td>
                                    <td class="px-6 py-4 text-center">System log analysis</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Scope</td>
                                    <td class="px-6 py-4 text-center">Desktop applications</td>
                                    <td class="px-6 py-4 text-center">Enterprise systems (ERP, CRM, etc.)</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">User Involvement</td>
                                    <td class="px-6 py-4 text-center">High (requires user consent)</td>
                                    <td class="px-6 py-4 text-center">Low (uses existing system data)</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Output</td>
                                    <td class="px-6 py-4 text-center">Automation recommendations</td>
                                    <td class="px-6 py-4 text-center">Process maps and insights</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Privacy Considerations</td>
                                    <td class="px-6 py-4 text-center">High (captures user screens)</td>
                                    <td class="px-6 py-4 text-center">Medium (uses system logs)</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Licensing</td>
                                    <td class="px-6 py-4 text-center">Included with RPA licenses</td>
                                    <td class="px-6 py-4 text-center">~$5,000/environment/month</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Integration Workflow -->
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 p-8 rounded-xl">
                    <h3 class="text-2xl font-bold mb-6 text-center">üîÑ How They Work Together</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="text-center">
                            <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">üëÅÔ∏è</span>
                            </div>
                            <h4 class="font-bold mb-2">1. Task Mining</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Record user desktop interactions to identify repetitive manual tasks and automation opportunities.</p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">‚õèÔ∏è</span>
                            </div>
                            <h4 class="font-bold mb-2">2. Process Mining</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Analyze business processes end-to-end to understand overall workflow and identify bottlenecks.</p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">‚ö°</span>
                            </div>
                            <h4 class="font-bold mb-2">3. Automation</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Use insights from both to implement targeted RPA solutions and optimize business processes.</p>
                        </div>
                    </div>
                    <div class="mt-8 p-4 bg-white/50 dark:bg-gray-800/50 rounded-lg">
                        <h4 class="font-semibold mb-2">üí° Pro Tip:</h4>
                        <p class="text-sm text-gray-700 dark:text-gray-300">Start with Process Mining to understand your overall business processes, then use Task Mining to identify specific automation opportunities within those processes. This combined approach provides the most comprehensive optimization strategy.</p>
                    </div>
                </div>
            </div>

            <!-- Security & Compliance Section -->
            <div x-show="activeSection === 'security'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">üõ°Ô∏è Security & Compliance Framework</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                        Comprehensive security features and compliance certifications built into the Microsoft Power Platform.
                    </p>
                </div>

                <!-- Security Overview Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <template x-for="category in securityCategories" :key="category.name">
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 text-center">
                            <div class="text-4xl mb-4" x-text="category.icon"></div>
                            <h3 class="font-bold text-lg mb-2" x-text="category.name"></h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400" x-text="category.description"></p>
                        </div>
                    </template>
                </div>

                <!-- Detailed Security Features -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <template x-for="(details, category) in securityDetails" :key="category">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
                            <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                                <h3 class="text-xl font-bold capitalize" x-text="category.replace('_', ' ')"></h3>
                            </div>
                            <div class="p-6">
                                <div class="space-y-4">
                                    <template x-for="feature in details" :key="feature.name">
                                        <div class="flex items-start space-x-3">
                                            <div class="flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center">
                                                <span class="text-green-600 text-xs">‚úì</span>
                                            </div>
                                            <div>
                                                <h4 class="font-medium" x-text="feature.name"></h4>
                                                <p class="text-sm text-gray-600 dark:text-gray-400" x-text="feature.description"></p>
                                                <div class="flex flex-wrap gap-1 mt-2">
                                                    <template x-for="product in feature.products" :key="product">
                                                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded" x-text="product"></span>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>

                <!-- Compliance Certifications -->
                <div class="bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 p-8 rounded-xl">
                    <h3 class="text-2xl font-bold mb-6 text-center">Compliance Certifications</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                        <template x-for="cert in complianceCerts" :key="cert.name">
                            <div class="bg-white dark:bg-gray-800 p-4 rounded-lg text-center shadow-md">
                                <div class="text-2xl mb-2" x-text="cert.icon"></div>
                                <h4 class="font-semibold text-sm" x-text="cert.name"></h4>
                                <p class="text-xs text-gray-600 dark:text-gray-400 mt-1" x-text="cert.description"></p>
                            </div>
                        </template>
                    </div>
                </div>
            </div>

            <!-- Licensing Section -->
            <div x-show="activeSection === 'licensing'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">üí∞ Licensing & Pricing Analysis</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                        Complete breakdown of Microsoft Power Platform licensing options, pricing tiers, and feature availability across all services.
                    </p>
                </div>

                <!-- Product Selection for Detailed View -->
                <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-xl">
                    <h3 class="text-lg font-semibold mb-4">Select Product for Detailed Licensing</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3">
                        <template x-for="(product, key) in licensingData" :key="key">
                            <button @click="selectedLicenseProduct = key"
                                    :class="selectedLicenseProduct === key ? 'bg-primary text-white' : 'bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600'"
                                    class="p-3 rounded-lg border border-gray-200 dark:border-gray-600 text-center transition-colors">
                                <div class="text-lg mb-1" x-text="product.icon"></div>
                                <div class="text-xs font-medium" x-text="product.name"></div>
                            </button>
                        </template>
                    </div>
                </div>

                <!-- Detailed Product Licensing Plans -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                        <div class="flex items-center space-x-3">
                            <span class="text-3xl" x-text="licensingData[selectedLicenseProduct]?.icon"></span>
                            <div>
                                <h3 class="text-2xl font-bold" x-text="licensingData[selectedLicenseProduct]?.name + ' Licensing Plans'"></h3>
                                <p class="text-gray-600 dark:text-gray-400" x-text="licensingData[selectedLicenseProduct]?.description"></p>
                            </div>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">Plan Name</th>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">Description</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Pricing</th>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">Key Features</th>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">Limitations</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                                <template x-for="plan in licensingData[selectedLicenseProduct]?.plans || []" :key="plan.name">
                                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                        <td class="px-6 py-4 font-semibold" x-text="plan.name"></td>
                                        <td class="px-6 py-4 text-sm" x-text="plan.description"></td>
                                        <td class="px-6 py-4 text-center">
                                            <span class="px-3 py-1 text-sm font-bold rounded-full"
                                                  :class="plan.pricing.includes('Free') ? 'bg-green-100 text-green-800' : 
                                                         plan.pricing.includes('~$') ? 'bg-blue-100 text-blue-800' : 
                                                         'bg-purple-100 text-purple-800'"
                                                  x-text="plan.pricing">
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 text-sm" x-text="plan.features"></td>
                                        <td class="px-6 py-4 text-sm text-gray-500" x-text="plan.limitations"></td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Quick Comparison Table -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                        <h3 class="text-xl font-bold">Quick Pricing Comparison</h3>
                        <p class="text-gray-600 dark:text-gray-400">Overview of pricing for each Power Platform service (Microsoft Official Pricing)</p>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">Service</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Free Tier</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Per App</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Per User</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Premium Plans</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-semibold">üì± Power Apps</td>
                                    <td class="px-6 py-4 text-center">‚úÖ Developer Plan</td>
                                    <td class="px-6 py-4 text-center font-semibold">$5/user/app</td>
                                    <td class="px-6 py-4 text-center font-semibold">$20/user/month</td>
                                    <td class="px-6 py-4 text-center">Basic (M365 included)</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-semibold">‚ö° Power Automate</td>
                                    <td class="px-6 py-4 text-center">‚úÖ M365 included</td>
                                    <td class="px-6 py-4 text-center">$100/flow/month</td>
                                    <td class="px-6 py-4 text-center font-semibold">$15/user/month</td>
                                    <td class="px-6 py-4 text-center">RPA: $40-150/bot</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-semibold">üìä Power BI</td>
                                    <td class="px-6 py-4 text-center">‚úÖ Desktop only</td>
                                    <td class="px-6 py-4 text-center">‚ùå Not available</td>
                                    <td class="px-6 py-4 text-center font-semibold">Pro: $10/user</td>
                                    <td class="px-6 py-4 text-center">Premium: $20/user, Embedded: Variable</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-semibold">üåê Power Pages</td>
                                    <td class="px-6 py-4 text-center">30-day trial</td>
                                    <td class="px-6 py-4 text-center">Pay-as-you-go</td>
                                    <td class="px-6 py-4 text-center">Authenticated users</td>
                                    <td class="px-6 py-4 text-center">Anonymous users</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-semibold">ü§ñ Copilot Studio</td>
                                    <td class="px-6 py-4 text-center">30-day trial</td>
                                    <td class="px-6 py-4 text-center">Per session</td>
                                    <td class="px-6 py-4 text-center">$200/10k sessions</td>
                                    <td class="px-6 py-4 text-center">Volume discounts</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-semibold">‚õèÔ∏è Process Mining</td>
                                    <td class="px-6 py-4 text-center">‚ùå Premium only</td>
                                    <td class="px-6 py-4 text-center">‚ùå Not available</td>
                                    <td class="px-6 py-4 text-center">$5,000/environment</td>
                                    <td class="px-6 py-4 text-center">Azure consumption</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-semibold">üëÅÔ∏è Task Mining</td>
                                    <td class="px-6 py-4 text-center">‚ùå Premium only</td>
                                    <td class="px-6 py-4 text-center">‚ùå Not available</td>
                                    <td class="px-6 py-4 text-center">Included with Power Automate RPA</td>
                                    <td class="px-6 py-4 text-center">Part of Power Automate</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-semibold">üóÑÔ∏è Dataverse</td>
                                    <td class="px-6 py-4 text-center">‚ùå Premium only</td>
                                    <td class="px-6 py-4 text-center">Included</td>
                                    <td class="px-6 py-4 text-center">Included</td>
                                    <td class="px-6 py-4 text-center">$40/GB additional</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-semibold">üß† AI Builder</td>
                                    <td class="px-6 py-4 text-center">‚ùå Credits only</td>
                                    <td class="px-6 py-4 text-center">Included credits</td>
                                    <td class="px-6 py-4 text-center">Included credits</td>
                                    <td class="px-6 py-4 text-center">$500/1M credits</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Advanced Licensing Calculator -->
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 p-8 rounded-xl">
                    <h3 class="text-2xl font-bold mb-6">Advanced License Cost Calculator</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-6">Configure different user counts and licensing models for each product</p>
                    
                    <!-- Product Configuration Grid -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <template x-for="(product, key) in getCalculatorProducts()" :key="key">
                            <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-600">
                                <div class="flex items-center justify-between mb-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" :value="product" x-model="calculator.products" 
                                               class="mr-3 rounded">
                                        <div class="flex items-center">
                                            <span x-text="licensingData[product].icon" class="text-lg mr-2"></span>
                                            <span x-text="licensingData[product].name" class="font-medium"></span>
                                        </div>
                                    </label>
                                </div>
                                <div x-show="calculator.products.includes(product)" class="space-y-3">
                                    <div class="grid grid-cols-2 gap-3">
                                        <div>
                                            <label class="block text-xs font-medium mb-1">Users</label>
                                            <input type="number" 
                                                   x-model.number="calculator.productUsers[product]"
                                                   @input="if (!calculator.productUsers[product]) calculator.productUsers[product] = 1"
                                                   min="1" 
                                                   class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-sm">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium mb-1">License Tier</label>
                                            <select x-model="calculator.productLicenseType[product]"
                                                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-sm">
                                                <template x-for="tier in getLicenseTiers(product)" :key="tier.value">
                                                    <option :value="tier.value" x-text="tier.name"></option>
                                                </template>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <span class="text-sm font-semibold text-primary" 
                                              x-text="'$' + getAdvancedProductCost(product).toLocaleString() + '/month'"></span>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>

                    <!-- Results Summary -->
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg">
                        <h4 class="text-lg font-semibold mb-4">Monthly Cost Summary</h4>
                        <div class="text-3xl font-bold text-primary mb-4" x-text="'$' + calculateAdvancedLicenseCost().toLocaleString()"></div>
                        
                        <div class="space-y-2 text-sm">
                            <template x-for="product in calculator.products" :key="product">
                                <div class="flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600">
                                    <div class="flex items-center">
                                        <span x-text="licensingData[product]?.icon" class="mr-2"></span>
                                        <span x-text="licensingData[product]?.name"></span>
                                        <span class="text-gray-500 ml-2" 
                                              x-text="'(' + (calculator.productUsers[product] || 1) + ' users, ' + (calculator.productLicenseType[product] || 'per_user').replace('_', ' ') + ')'"></span>
                                    </div>
                                    <span class="font-semibold" x-text="'$' + getAdvancedProductCost(product).toLocaleString()"></span>
                                </div>
                            </template>
                        </div>
                        
                        <!-- Capabilities Summary -->
                        <div class="mt-6 space-y-4">
                            <h5 class="font-semibold text-base">What You Can Do With These Licenses:</h5>
                            <template x-for="product in calculator.products" :key="product">
                                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                                    <div class="flex items-center mb-2">
                                        <span x-text="licensingData[product]?.icon" class="mr-2"></span>
                                        <h6 class="font-medium" x-text="licensingData[product]?.name"></h6>
                                        <span class="ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded" 
                                              x-text="(calculator.productLicenseType[product] || 'premium').replace('_', ' ')"></span>
                                    </div>
                                    <ul class="text-sm space-y-1">
                                        <template x-for="capability in getLicenseCapabilities(product, calculator.productLicenseType[product] || 'premium')" :key="capability">
                                            <li class="flex items-start">
                                                <span class="text-green-500 mr-2 mt-1">‚Ä¢</span>
                                                <span x-text="capability"></span>
                                            </li>
                                        </template>
                                    </ul>
                                </div>
                            </template>
                        </div>

                        <div class="mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded text-xs text-gray-600 dark:text-gray-400">
                            <strong>Note:</strong> Prices are based on Microsoft's official pricing as of January 2025. 
                            Power Apps Basic and Power Automate basic flows are included with certain Microsoft 365 licenses.
                            Dataverse capacity and AI Builder credits are included with premium licenses but may require additional capacity.
                            <br><br>
                            <strong>Task Mining:</strong> Included with Power Automate RPA Attended ($40/user) and RPA Unattended ($150/bot) licenses.
                        </div>
                    </div>
                </div>

                <!-- AI Builder vs Azure Form Recognizer in License Calculator -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20">
                        <h3 class="text-2xl font-bold">üìÑ Document Processing: AI Builder vs Azure Form Recognizer</h3>
                        <p class="text-gray-600 dark:text-gray-400 mt-2">Compare document processing costs for your licensing decision</p>
                    </div>
                    <div class="p-8">
                        <!-- Quick Comparison Cards -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                            <div class="bg-gradient-to-br from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-purple-200 dark:border-purple-700">
                                <div class="flex items-center mb-4">
                                    <span class="text-3xl mr-3">üü™</span>
                                    <div>
                                        <h4 class="text-xl font-bold text-purple-800 dark:text-purple-300">AI Builder</h4>
                                        <p class="text-purple-600 dark:text-purple-400 text-sm">Included with Power Platform licenses</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg">
                                        <h5 class="font-semibold mb-2">Pricing Structure:</h5>
                                        <ul class="text-sm space-y-1">
                                            <li>‚Ä¢ $500 per 1 million credits</li>
                                            <li>‚Ä¢ ~5 credits per page = $0.0025/page</li>
                                            <li class="text-green-600 font-medium">‚Ä¢ 5,000 credits/month included</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h5 class="font-semibold mb-2">Best For:</h5>
                                        <ul class="text-sm space-y-1">
                                            <li>‚Ä¢ Power Platform users</li>
                                            <li>‚Ä¢ < 1,000 pages/month (FREE)</li>
                                            <li>‚Ä¢ Quick implementation</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-700">
                                <div class="flex items-center mb-4">
                                    <span class="text-3xl mr-3">üü¶</span>
                                    <div>
                                        <h4 class="text-xl font-bold text-blue-800 dark:text-blue-300">Azure Form Recognizer</h4>
                                        <p class="text-blue-600 dark:text-blue-400 text-sm">Standalone Azure service</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg">
                                        <h5 class="font-semibold mb-2">Pricing Structure:</h5>
                                        <ul class="text-sm space-y-1">
                                            <li>‚Ä¢ $0.01 per page processed</li>
                                            <li>‚Ä¢ Document Classification: $0.002/page</li>
                                            <li>‚Ä¢ Custom training: Free</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h5 class="font-semibold mb-2">Best For:</h5>
                                        <ul class="text-sm space-y-1">
                                            <li>‚Ä¢ High-volume processing</li>
                                            <li>‚Ä¢ Advanced document AI</li>
                                            <li>‚Ä¢ Custom ML models</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Interactive Cost Calculator -->
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 p-6 rounded-xl mb-6" x-data="{ docPages: 1000 }">
                            <h4 class="text-xl font-bold mb-4 text-center">üí∞ Document Processing Cost Calculator</h4>
                            <div class="max-w-md mx-auto mb-6">
                                <label class="block text-sm font-medium mb-2">Monthly Pages to Process:</label>
                                <input type="number" x-model.number="docPages" min="1" max="1000000" 
                                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base text-center font-bold">
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg text-center">
                                    <h5 class="font-semibold text-purple-600 mb-3">üü™ AI Builder Cost</h5>
                                    <div class="space-y-2">
                                        <div x-show="docPages * 5 <= 5000" class="text-2xl font-bold text-green-600">
                                            FREE
                                        </div>
                                        <div x-show="docPages * 5 > 5000" class="text-2xl font-bold text-purple-600">
                                            $<span x-text="Math.ceil((docPages * 5 - 5000) / 1000000 * 500)"></span>
                                        </div>
                                        <p class="text-xs text-gray-500">
                                            <span x-text="docPages * 5"></span> credits needed
                                            <span x-show="docPages * 5 <= 5000">(covered by license)</span>
                                        </p>
                                    </div>
                                </div>
                                
                                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg text-center">
                                    <h5 class="font-semibold text-blue-600 mb-3">üü¶ Azure Form Recognizer Cost</h5>
                                    <div class="space-y-2">
                                        <div class="text-2xl font-bold text-blue-600">
                                            $<span x-text="(docPages * 0.01).toFixed(0)"></span>
                                        </div>
                                        <p class="text-xs text-gray-500">
                                            $0.01 √ó <span x-text="docPages.toLocaleString()"></span> pages
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg text-center">
                                <div x-show="docPages * 5 <= 5000">
                                    <p class="text-green-600 font-semibold">‚úÖ AI Builder is FREE at this volume (covered by license)</p>
                                    <p class="text-sm text-gray-500 mt-2">5,000 credits/month included with Power Platform Premium licenses</p>
                                </div>
                                <div x-show="docPages * 5 > 5000 && (docPages * 0.0025) < (docPages * 0.01)">
                                    <p class="text-purple-600 font-semibold">üü™ AI Builder is cheaper: $<span x-text="Math.ceil((docPages * 5 - 5000) / 1000000 * 500)"></span> vs $<span x-text="(docPages * 0.01).toFixed(0)"></span></p>
                                    <p class="text-sm text-gray-500 mt-2">AI Builder wins due to lower per-page cost</p>
                                </div>
                                <div x-show="docPages * 5 > 5000 && (docPages * 0.0025) >= (docPages * 0.01)">
                                    <p class="text-blue-600 font-semibold">üü¶ Azure Form Recognizer is cheaper: $<span x-text="(docPages * 0.01).toFixed(0)"></span> vs $<span x-text="Math.ceil((docPages * 5 - 5000) / 1000000 * 500)"></span></p>
                                    <p class="text-sm text-gray-500 mt-2">Azure wins at very high volumes</p>
                                </div>
                            </div>
                        </div>

                        <!-- Feature Comparison Table -->
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-xl overflow-hidden mb-6">
                            <div class="p-4 border-b border-gray-200 dark:border-gray-600">
                                <h4 class="text-lg font-bold">üìä Feature Comparison for License Planning</h4>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-100 dark:bg-gray-600">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold">Feature</th>
                                            <th class="px-4 py-3 text-center text-sm font-semibold">üü™ AI Builder</th>
                                            <th class="px-4 py-3 text-center text-sm font-semibold">üü¶ Azure Form Recognizer</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-200 dark:divide-gray-600 text-sm">
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-4 py-3 font-medium">License Integration</td>
                                            <td class="px-4 py-3 text-center text-green-600">‚úÖ Included with Power Platform</td>
                                            <td class="px-4 py-3 text-center text-orange-600">‚ö†Ô∏è Requires separate Azure subscription</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-4 py-3 font-medium">Setup Complexity</td>
                                            <td class="px-4 py-3 text-center text-green-600">‚úÖ No-code setup</td>
                                            <td class="px-4 py-3 text-center text-orange-600">‚ö†Ô∏è API development required</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-4 py-3 font-medium">Price Predictability</td>
                                            <td class="px-4 py-3 text-center text-green-600">‚úÖ Credit-based, predictable</td>
                                            <td class="px-4 py-3 text-center text-blue-600">‚úÖ Simple per-page pricing</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-4 py-3 font-medium">Volume Scaling</td>
                                            <td class="px-4 py-3 text-center text-orange-600">‚ö†Ô∏è Credit consumption increases</td>
                                            <td class="px-4 py-3 text-center text-green-600">‚úÖ Linear scaling</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                            <td class="px-4 py-3 font-medium">Admin Overhead</td>
                                            <td class="px-4 py-3 text-center text-green-600">‚úÖ Managed within Power Platform</td>
                                            <td class="px-4 py-3 text-center text-orange-600">‚ö†Ô∏è Separate Azure resource management</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- License Planning Recommendations -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="bg-purple-50 dark:bg-purple-900/20 p-6 rounded-lg">
                                <h4 class="font-semibold text-purple-800 dark:text-purple-300 mb-4">üü™ Include AI Builder in License Planning When:</h4>
                                <ul class="space-y-2 text-sm">
                                    <li class="flex items-start space-x-2">
                                        <span class="text-green-500 mt-1">‚úÖ</span>
                                        <span>Already planning Power Platform Premium licenses</span>
                                    </li>
                                    <li class="flex items-start space-x-2">
                                        <span class="text-green-500 mt-1">‚úÖ</span>
                                        <span>Processing < 1,000 pages/month (effectively free)</span>
                                    </li>
                                    <li class="flex items-start space-x-2">
                                        <span class="text-green-500 mt-1">‚úÖ</span>
                                        <span>Want no-code document processing</span>
                                    </li>
                                    <li class="flex items-start space-x-2">
                                        <span class="text-green-500 mt-1">‚úÖ</span>
                                        <span>Prefer unified Power Platform licensing</span>
                                    </li>
                                </ul>
                            </div>
                            
                            <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg">
                                <h4 class="font-semibold text-blue-800 dark:text-blue-300 mb-4">üü¶ Consider Azure Form Recognizer When:</h4>
                                <ul class="space-y-2 text-sm">
                                    <li class="flex items-start space-x-2">
                                        <span class="text-blue-500 mt-1">üíô</span>
                                        <span>Processing 10,000+ pages/month</span>
                                    </li>
                                    <li class="flex items-start space-x-2">
                                        <span class="text-blue-500 mt-1">üíô</span>
                                        <span>Need advanced custom ML models</span>
                                    </li>
                                    <li class="flex items-start space-x-2">
                                        <span class="text-blue-500 mt-1">üíô</span>
                                        <span>Already have Azure subscriptions</span>
                                    </li>
                                    <li class="flex items-start space-x-2">
                                        <span class="text-blue-500 mt-1">üíô</span>
                                        <span>Have development team for API integration</span>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Cost Scenarios -->
                        <div class="mt-8 bg-gray-50 dark:bg-gray-700 p-6 rounded-xl">
                            <h4 class="text-lg font-bold mb-4 text-center">üíº Real-World License Planning Scenarios</h4>
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg">
                                    <h5 class="font-semibold text-green-800 dark:text-green-300 mb-2">üìÑ Small Volume (500 pages/month)</h5>
                                    <div class="space-y-1 text-sm">
                                        <p><strong>AI Builder:</strong> FREE (included)</p>
                                        <p><strong>Azure:</strong> $5/month</p>
                                        <p class="text-green-600 font-medium">üí° AI Builder saves $60/year</p>
                                        <p class="text-xs text-gray-500">Recommendation: Use AI Builder</p>
                                    </div>
                                </div>
                                
                                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg">
                                    <h5 class="font-semibold text-yellow-800 dark:text-yellow-300 mb-2">üìä Medium Volume (5,000 pages/month)</h5>
                                    <div class="space-y-1 text-sm">
                                        <p><strong>AI Builder:</strong> $12.50/month</p>
                                        <p><strong>Azure:</strong> $50/month</p>
                                        <p class="text-green-600 font-medium">üí° AI Builder saves $450/year</p>
                                        <p class="text-xs text-gray-500">Recommendation: Use AI Builder</p>
                                    </div>
                                </div>
                                
                                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg">
                                    <h5 class="font-semibold text-blue-800 dark:text-blue-300 mb-2">üìà High Volume (50,000 pages/month)</h5>
                                    <div class="space-y-1 text-sm">
                                        <p><strong>AI Builder:</strong> $125/month</p>
                                        <p><strong>Azure:</strong> $500/month</p>
                                        <p class="text-green-600 font-medium">üí° AI Builder saves $4,500/year</p>
                                        <p class="text-xs text-gray-500">Recommendation: Still AI Builder!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ROA Calculator Section -->
            <div x-show="activeSection === 'roa'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">‚ö° Return on Automation (ROA) Calculator</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                        Calculate the time savings, efficiency gains, and productivity improvements from automating manual processes with Power Platform.
                    </p>
                </div>

                <!-- ROA Input Parameters -->
                <div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold mb-6">Automation Scenario Parameters</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">Process Type</label>
                            <select x-model="roa.processType" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                                <option value="data_entry">Data Entry & Processing</option>
                                <option value="approvals">Approval Workflows</option>
                                <option value="reporting">Report Generation</option>
                                <option value="customer_service">Customer Service</option>
                                <option value="hr_onboarding">HR Onboarding</option>
                                <option value="invoice_processing">Invoice Processing</option>
                                <option value="inventory_management">Inventory Management</option>
                                <option value="custom">Custom Process</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Users Affected</label>
                            <input type="number" x-model.number="roa.usersAffected" min="1" 
                                   class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Time per Task (minutes)</label>
                            <input type="number" x-model.number="roa.timePerTask" min="1" 
                                   class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Tasks per Day</label>
                            <input type="number" x-model.number="roa.tasksPerDay" min="1" 
                                   class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Working Days per Year</label>
                            <input type="number" x-model.number="roa.workingDaysPerYear" min="200" max="365" 
                                   class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-2">Automation Efficiency (%)</label>
                            <input type="number" x-model.number="roa.automationEfficiency" min="50" max="100" 
                                   class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Error Reduction (%)</label>
                            <input type="number" x-model.number="roa.errorReduction" min="0" max="100" 
                                   class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </div>
                    </div>
                </div>

                <!-- ROA Results Dashboard -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Time & Productivity Savings -->
                    <div class="bg-gradient-success p-8 rounded-2xl shadow-card-hover text-white">
                        <h3 class="text-xl font-bold mb-6 text-white/90">‚è∞ Time & Productivity Savings</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-white/90">Hours Saved per Day</span>
                                <span class="font-bold text-2xl text-white" x-text="calculateROA().hoursPerDay.toFixed(1)"></span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-white/90">Hours Saved per Year</span>
                                <span class="font-bold text-2xl text-white" x-text="calculateROA().hoursPerYear.toLocaleString()"></span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-white/90">Equivalent Full-Time Employees</span>
                                <span class="font-bold text-2xl text-white" x-text="calculateROA().equivalentFTE.toFixed(1)"></span>
                            </div>
                            <div class="border-t border-white/20 pt-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-white/90">Tasks Automated per Day</span>
                                    <span class="font-bold text-3xl text-white" x-text="calculateROA().automatedTasksPerDay.toLocaleString()"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quality & Error Reduction -->
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-8 rounded-xl">
                        <h3 class="text-xl font-bold mb-6 text-blue-800 dark:text-blue-300">üéØ Quality & Error Reduction</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span>Error Reduction</span>
                                <span class="font-bold text-2xl text-blue-600" x-text="roa.errorReduction + '%'"></span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span>Process Accuracy</span>
                                <span class="font-bold text-2xl text-blue-600" x-text="(100 - (100 - roa.errorReduction) * 0.1).toFixed(1) + '%'"></span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span>Compliance Improvement</span>
                                <span class="font-bold text-2xl text-blue-600">+95%</span>
                            </div>
                            <div class="border-t border-blue-200 pt-4">
                                <div class="flex justify-between items-center">
                                    <span>Availability Improvement</span>
                                    <span class="font-bold text-3xl text-blue-600" x-text="calculateROA().availabilityIncrease + '%'"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Process Automation Benefits -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                        <h3 class="text-xl font-bold">üîÑ Manual vs Automated Process Comparison</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">Aspect</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Manual Process</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Power Platform Automation</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Improvement</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Processing Time</td>
                                    <td class="px-6 py-4 text-center text-red-600" x-text="roa.timePerTask + ' minutes'"></td>
                                    <td class="px-6 py-4 text-center text-green-600" x-text="Math.round(roa.timePerTask * (100 - roa.automationEfficiency) / 100) + ' minutes'"></td>
                                    <td class="px-6 py-4 text-center font-bold text-green-600" x-text="roa.automationEfficiency + '% faster'"></td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Error Rate</td>
                                    <td class="px-6 py-4 text-center text-red-600">5-15%</td>
                                    <td class="px-6 py-4 text-center text-green-600" x-text="(100 - roa.errorReduction) * 0.1 + '%'"></td>
                                    <td class="px-6 py-4 text-center font-bold text-green-600" x-text="roa.errorReduction + '% reduction'"></td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Availability</td>
                                    <td class="px-6 py-4 text-center text-red-600">8 hours/day</td>
                                    <td class="px-6 py-4 text-center text-green-600">24/7</td>
                                    <td class="px-6 py-4 text-center font-bold text-green-600">300% increase</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Scalability</td>
                                    <td class="px-6 py-4 text-center text-red-600">Linear scaling</td>
                                    <td class="px-6 py-4 text-center text-green-600">Exponential scaling</td>
                                    <td class="px-6 py-4 text-center font-bold text-green-600">Unlimited capacity</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Consistency</td>
                                    <td class="px-6 py-4 text-center text-red-600">Variable</td>
                                    <td class="px-6 py-4 text-center text-green-600">100% Consistent</td>
                                    <td class="px-6 py-4 text-center font-bold text-green-600">Perfect compliance</td>
                                </tr>
                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <td class="px-6 py-4 font-medium">Documentation</td>
                                    <td class="px-6 py-4 text-center text-red-600">Manual tracking</td>
                                    <td class="px-6 py-4 text-center text-green-600">Automatic audit trail</td>
                                    <td class="px-6 py-4 text-center font-bold text-green-600">100% auditable</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ROA by Process Type -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold mb-4">üìä Process-Specific Benefits</h3>
                        <div class="space-y-4" x-show="getProcessBenefits(roa.processType)">
                            <template x-for="benefit in getProcessBenefits(roa.processType)" :key="benefit.name">
                                <div class="flex items-start space-x-3">
                                    <div class="flex-shrink-0 w-6 h-6 bg-primary rounded-full flex items-center justify-center">
                                        <span class="text-white text-xs">‚úì</span>
                                    </div>
                                    <div>
                                        <h4 class="font-medium" x-text="benefit.name"></h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400" x-text="benefit.description"></p>
                                        <span class="text-sm font-semibold text-primary" x-text="benefit.impact"></span>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold mb-4">üéØ Recommended Power Platform Tools</h3>
                        <div class="space-y-4" x-show="getRecommendedTools(roa.processType)">
                            <template x-for="tool in getRecommendedTools(roa.processType)" :key="tool.name">
                                <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <div class="flex items-center mb-2">
                                        <span x-text="tool.icon" class="text-lg mr-2"></span>
                                        <h4 class="font-medium" x-text="tool.name"></h4>
                                    </div>
                                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-2" x-text="tool.description"></p>
                                    <div class="flex flex-wrap gap-1">
                                        <template x-for="feature in tool.features" :key="feature">
                                            <span class="px-2 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200 text-xs rounded" x-text="feature"></span>
                                        </template>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>

                <!-- ROA Summary -->
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-8 rounded-xl text-center">
                    <h3 class="text-2xl font-bold mb-4">üöÄ Your Automation ROA Summary</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                        <div>
                            <div class="text-3xl font-bold text-purple-600 mb-2" x-text="calculateROA().efficiencyGain + '%'"></div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Efficiency Improvement</p>
                        </div>
                        <div>
                            <div class="text-3xl font-bold text-purple-600 mb-2" x-text="calculateROA().errorReduction + '%'"></div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Error Reduction</p>
                        </div>
                        <div>
                            <div class="text-3xl font-bold text-purple-600 mb-2" x-text="calculateROA().hoursPerYear.toLocaleString()""></div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Hours Saved Annually</p>
                        </div>
                    </div>
                    <p class="text-lg text-gray-600 dark:text-gray-400">
                        By automating this process with Power Platform, you can save <strong x-text="calculateROA().hoursPerYear.toLocaleString() + ' hours'"></strong> 
                        annually, equivalent to <strong x-text="calculateROA().equivalentFTE.toFixed(1) + ' full-time employees'"></strong>, 
                        while improving process efficiency by <strong x-text="calculateROA().efficiencyGain + '%'"></strong> and reducing errors by <strong x-text="calculateROA().errorReduction + '%'"></strong>.
                    </p>
                </div>
            </div>

            <!-- Comparison Section -->
            <div x-show="activeSection === 'comparison'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">üîÅ Traditional Solutions Comparison</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                        Compare Power Platform against traditional development approaches and alternative platforms.
                    </p>
                </div>

                <!-- Comparison Matrix -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">Feature</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Power Platform</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Custom Development</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">WordPress + Plugins</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Firebase/AWS</th>
                                    <th class="px-6 py-4 text-center text-sm font-semibold">Other Low-Code</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                                <template x-for="comparison in comparisonData" :key="comparison.feature">
                                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                        <td class="px-6 py-4 font-medium" x-text="comparison.feature"></td>
                                        <td class="px-6 py-4 text-center">
                                            <div class="flex flex-col items-center">
                                                <span class="text-lg" x-text="comparison.powerPlatform.rating"></span>
                                                <span class="text-xs text-gray-500" x-text="comparison.powerPlatform.note"></span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 text-center">
                                            <div class="flex flex-col items-center">
                                                <span class="text-lg" x-text="comparison.custom.rating"></span>
                                                <span class="text-xs text-gray-500" x-text="comparison.custom.note"></span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 text-center">
                                            <div class="flex flex-col items-center">
                                                <span class="text-lg" x-text="comparison.wordpress.rating"></span>
                                                <span class="text-xs text-gray-500" x-text="comparison.wordpress.note"></span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 text-center">
                                            <div class="flex flex-col items-center">
                                                <span class="text-lg" x-text="comparison.cloud.rating"></span>
                                                <span class="text-xs text-gray-500" x-text="comparison.cloud.note"></span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 text-center">
                                            <div class="flex flex-col items-center">
                                                <span class="text-lg" x-text="comparison.lowCode.rating"></span>
                                                <span class="text-xs text-gray-500" x-text="comparison.lowCode.note"></span>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Cost Breakdown -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold mb-4">Power Platform Total Cost</h3>
                        <div class="space-y-3">
                            <template x-for="cost in powerPlatformCosts" :key="cost.item">
                                <div class="flex justify-between items-center">
                                    <span x-text="cost.item"></span>
                                    <span class="font-semibold" x-text="cost.cost"></span>
                                </div>
                            </template>
                            <div class="border-t pt-3 flex justify-between items-center text-lg font-bold">
                                <span>Monthly Total</span>
                                <span class="text-primary">$320-520</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold mb-4">Traditional Development Cost</h3>
                        <div class="space-y-3">
                            <template x-for="cost in traditionalCosts" :key="cost.item">
                                <div class="flex justify-between items-center">
                                    <span x-text="cost.item"></span>
                                    <span class="font-semibold" x-text="cost.cost"></span>
                                </div>
                            </template>
                            <div class="border-t pt-3 flex justify-between items-center text-lg font-bold">
                                <span>Monthly Total</span>
                                <span class="text-red-600">$1,800-2,500</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TCO Calculator Section -->
            <div x-show="activeSection === 'tco'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">üìä Total Cost of Ownership Calculator</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                        Calculate and compare the total cost of ownership between Power Platform and traditional solutions over time.
                    </p>
                </div>

                <!-- TCO Input Form -->
                <div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold mb-6">Project Parameters</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">Users</label>
                            <input type="number" x-model.number="tco.users" min="1" 
                                   class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Project Timeline (years)</label>
                            <input type="number" x-model.number="tco.years" min="1" max="10" 
                                   class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Complexity</label>
                            <select x-model="tco.complexity" 
                                    class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                                <option value="simple">Simple (Forms, Basic Reports)</option>
                                <option value="medium">Medium (Workflows, Integrations)</option>
                                <option value="complex">Complex (Custom Logic, APIs)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Business Size</label>
                            <select x-model="tco.businessSize" 
                                    class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-base">
                                <option value="small">SME (1-50 employees)</option>
                                <option value="medium">Medium (51-500 employees)</option>
                                <option value="large">Enterprise (500+ employees)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- TCO Results -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-8 rounded-xl">
                        <h3 class="text-xl font-bold mb-6 text-blue-800 dark:text-blue-300">Power Platform TCO</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between">
                                <span>Initial Setup</span>
                                <span class="font-semibold" x-text="'$' + calculateTCO('powerplatform').initial.toLocaleString()"></span>
                            </div>
                            <div class="flex justify-between">
                                <span>Annual Licensing</span>
                                <span class="font-semibold" x-text="'$' + calculateTCO('powerplatform').annual.toLocaleString()"></span>
                            </div>
                            <div class="flex justify-between">
                                <span>Maintenance (per year)</span>
                                <span class="font-semibold" x-text="'$' + calculateTCO('powerplatform').maintenance.toLocaleString()"></span>
                            </div>
                            <div class="border-t border-blue-200 pt-4">
                                <div class="flex justify-between text-xl font-bold">
                                    <span>Total (<span x-text="tco.years"></span> years)</span>
                                    <span class="text-blue-600" x-text="'$' + calculateTCO('powerplatform').total.toLocaleString()"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 p-8 rounded-xl">
                        <h3 class="text-xl font-bold mb-6 text-red-800 dark:text-red-300">Traditional Development TCO</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between">
                                <span>Initial Development</span>
                                <span class="font-semibold" x-text="'$' + calculateTCO('traditional').initial.toLocaleString()"></span>
                            </div>
                            <div class="flex justify-between">
                                <span>Annual Infrastructure</span>
                                <span class="font-semibold" x-text="'$' + calculateTCO('traditional').annual.toLocaleString()"></span>
                            </div>
                            <div class="flex justify-between">
                                <span>Maintenance (per year)</span>
                                <span class="font-semibold" x-text="'$' + calculateTCO('traditional').maintenance.toLocaleString()"></span>
                            </div>
                            <div class="border-t border-red-200 pt-4">
                                <div class="flex justify-between text-xl font-bold">
                                    <span>Total (<span x-text="tco.years"></span> years)</span>
                                    <span class="text-red-600" x-text="'$' + calculateTCO('traditional').total.toLocaleString()"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Savings Summary -->
                <div class="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-8 rounded-xl text-center">
                    <h3 class="text-2xl font-bold mb-4">Potential Savings with Power Platform</h3>
                    <div class="text-4xl font-bold text-green-600 mb-2" 
                         x-text="'$' + (calculateTCO('traditional').total - calculateTCO('powerplatform').total).toLocaleString()">
                    </div>
                    <p class="text-lg text-gray-600 dark:text-gray-400" 
                       x-text="Math.round(((calculateTCO('traditional').total - calculateTCO('powerplatform').total) / calculateTCO('traditional').total) * 100) + '% cost reduction over ' + tco.years + ' years'">
                    </p>
                </div>
            </div>

            <!-- Task Automation Section -->
            <div x-show="activeSection === 'automation'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">üîß Manual Task Automation Solutions</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                        Select your manual tasks to discover automation solutions using Power Platform, Azure DevOps, SharePoint, Task Mining, and Microsoft 365.
                    </p>
                </div>

                <!-- Task Selection Filters -->
                <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg">
                    <h3 class="text-lg font-semibold mb-4">Filter Tasks by Department</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4">
                        <template x-for="(department, key) in automationDepartments" :key="key">
                            <button @click="automationFilters.department = automationFilters.department === key ? '' : key"
                                    :class="automationFilters.department === key ? 'bg-gradient-primary text-white' : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'"
                                    class="p-3 rounded-lg text-center transition-colors">
                                <div class="text-2xl mb-1" x-text="department.icon"></div>
                                <div class="text-xs font-medium" x-text="department.name"></div>
                            </button>
                        </template>
                    </div>
                    
                    <!-- Selected Tasks Counter -->
                    <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">Selected Tasks: <span x-text="selectedTasks.length" class="font-bold text-blue-600"></span></span>
                            <div class="space-x-2">
                                <button @click="selectedTasks = []" class="px-3 py-1 bg-gray-500 text-white rounded text-sm hover:bg-gray-600">
                                    Clear All
                                </button>
                                <button @click="selectAllVisibleTasks()" class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">
                                    Select All Visible
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Task Selection Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <template x-for="(taskList, department) in getFilteredAutomationTasks()" :key="department">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
                            <div class="p-6 border-b border-gray-200 dark:border-gray-700" :style="'background: linear-gradient(135deg, ' + automationDepartments[department].color + '20, ' + automationDepartments[department].color + '10)'">
                                <div class="flex items-center">
                                    <span class="text-3xl mr-3" x-text="automationDepartments[department].icon"></span>
                                    <div>
                                        <h3 class="text-xl font-bold" x-text="automationDepartments[department].name"></h3>
                                        <p class="text-gray-600 dark:text-gray-400" x-text="automationDepartments[department].description"></p>
                                    </div>
                                </div>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3">
                                    <template x-for="task in taskList" :key="task.id">
                                        <label class="flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors">
                                            <input type="checkbox" 
                                                   :value="task.id" 
                                                   x-model="selectedTasks" 
                                                   class="mt-1 rounded">
                                            <div class="flex-1">
                                                <h4 class="font-medium text-sm" x-text="task.manual"></h4>
                                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1" x-text="task.automated"></p>
                                                <div class="flex flex-wrap gap-1 mt-2">
                                                    <template x-for="tool in task.tools" :key="tool">
                                                        <span class="px-2 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200 text-xs rounded" x-text="tool"></span>
                                                    </template>
                                                </div>
                                            </div>
                                        </label>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>

                <!-- Automation Solutions for Selected Tasks -->
                <div x-show="selectedTasks.length > 0" class="space-y-8">
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-8 rounded-xl">
                        <h3 class="text-2xl font-bold mb-6 text-center">üöÄ Your Custom Automation Solutions</h3>
                        
                        <!-- Solution Summary -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="text-center">
                                <div class="text-3xl font-bold text-green-600 mb-2" x-text="selectedTasks.length"></div>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Tasks Selected</p>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-green-600 mb-2" x-text="getUniqueTools().length"></div>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Tools Recommended</p>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-green-600 mb-2" x-text="Math.round(selectedTasks.length * 15) + '%'"></div>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Estimated Time Savings</p>
                            </div>
                        </div>

                        <!-- Recommended Tools Overview -->
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg mb-6">
                            <h4 class="text-lg font-semibold mb-4">üõ†Ô∏è Recommended Tools for Your Selection</h4>
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                                <template x-for="tool in getUniqueTools()" :key="tool">
                                    <div class="flex items-center p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                        <span x-text="getToolIcon(tool)" class="text-lg mr-2"></span>
                                        <span class="text-sm font-medium" x-text="tool"></span>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>

                    <!-- Detailed Solutions -->
                    <div class="space-y-6">
                        <h3 class="text-2xl font-bold text-center mb-6">üìã Detailed Automation Solutions</h3>
                        <template x-for="taskId in selectedTasks" :key="taskId">
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden">
                                <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800">
                                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                        <div>
                                            <h4 class="font-semibold text-red-600 mb-2">‚ùå Manual Process</h4>
                                            <p class="text-sm" x-text="getTaskById(taskId)?.manual"></p>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-green-600 mb-2">‚úÖ Automated Solution</h4>
                                            <p class="text-sm" x-text="getTaskById(taskId)?.automated"></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-6">
                                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                        <div>
                                            <h5 class="font-semibold mb-3">üõ†Ô∏è Required Tools</h5>
                                            <div class="space-y-2">
                                                <template x-for="tool in getTaskById(taskId)?.tools || []" :key="tool">
                                                    <div class="flex items-center p-2 bg-blue-50 dark:bg-blue-900/20 rounded">
                                                        <span x-text="getToolIcon(tool)" class="text-lg mr-3"></span>
                                                        <div>
                                                            <span class="font-medium text-sm" x-text="tool"></span>
                                                            <p class="text-xs text-gray-500" x-text="getToolDescription(tool)"></p>
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                        <div>
                                            <h5 class="font-semibold mb-3">üí° Implementation Benefits</h5>
                                            <div class="space-y-2">
                                                <template x-for="benefit in getTaskById(taskId)?.benefits || []" :key="benefit">
                                                    <div class="flex items-start space-x-2">
                                                        <span class="text-green-500 mt-1">‚Ä¢</span>
                                                        <span class="text-sm" x-text="benefit"></span>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Implementation Steps -->
                                    <div class="mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <h5 class="font-semibold mb-3">üöÄ Quick Implementation Guide</h5>
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <template x-for="(step, index) in getTaskById(taskId)?.steps || []" :key="index">
                                                <div class="flex items-start space-x-2">
                                                    <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold" x-text="index + 1"></div>
                                                    <span class="text-sm" x-text="step"></span>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>

                    <!-- Implementation Roadmap -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8">
                        <h3 class="text-2xl font-bold mb-6 text-center">üó∫Ô∏è Project Management Implementation Roadmap</h3>
                        
                        <!-- Project Phases -->
                        <div class="grid grid-cols-1 lg:grid-cols-5 gap-4 mb-8">
                            <template x-for="(phase, key) in getProjectManagementPhases()" :key="key">
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                                        <span class="text-2xl" x-text="phase.icon"></span>
                                    </div>
                                    <h4 class="font-bold mb-2" x-text="phase.name"></h4>
                                    <div class="text-2xl font-bold text-blue-600 mb-2" x-text="phase.hours + 'h'"></div>
                                    <p class="text-xs text-gray-600 dark:text-gray-400 mb-3">Capacity Hours Required</p>
                                    <div class="space-y-1">
                                        <template x-for="activity in phase.activities.slice(0, 3)" :key="activity">
                                            <div class="text-xs bg-gray-50 dark:bg-gray-700 p-2 rounded" x-text="activity"></div>
                                        </template>
                                    </div>
                                </div>
                            </template>
                        </div>

                        <!-- Enhanced Project Management Features -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-6 rounded-lg">
                                <h4 class="text-lg font-semibold mb-4 text-green-800 dark:text-green-300">üß™ Testing & Quality Assurance</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Testing Hours</span>
                                        <span class="font-bold text-green-600" x-text="calculateImplementationCost().testingHours + 'h'"></span>
                                    </div>
                                    <div class="text-xs space-y-2">
                                        <div class="flex items-center space-x-2">
                                            <span class="w-2 h-2 bg-green-400 rounded-full"></span>
                                            <span>Automated unit testing for Power Automate flows</span>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <span class="w-2 h-2 bg-green-400 rounded-full"></span>
                                            <span>User acceptance testing (UAT) coordination</span>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <span class="w-2 h-2 bg-green-400 rounded-full"></span>
                                            <span>Performance testing with realistic data volumes</span>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <span class="w-2 h-2 bg-green-400 rounded-full"></span>
                                            <span>Security and compliance validation</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-6 rounded-lg">
                                <h4 class="text-lg font-semibold mb-4 text-purple-800 dark:text-purple-300">üöÄ Innovation & Optimization</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Innovation Hours</span>
                                        <span class="font-bold text-purple-600" x-text="calculateImplementationCost().innovationHours + 'h'"></span>
                                    </div>
                                    <div class="text-xs space-y-2">
                                        <div class="flex items-center space-x-2">
                                            <span class="w-2 h-2 bg-purple-400 rounded-full"></span>
                                            <span>AI Builder model optimization and training</span>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <span class="w-2 h-2 bg-purple-400 rounded-full"></span>
                                            <span>Advanced Power BI analytics and insights</span>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <span class="w-2 h-2 bg-purple-400 rounded-full"></span>
                                            <span>Process mining implementation for continuous improvement</span>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <span class="w-2 h-2 bg-purple-400 rounded-full"></span>
                                            <span>Copilot Studio chatbot enhancement</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Detailed License Requirements -->
                        <div class="mt-8 p-6 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg">
                            <h4 class="text-lg font-semibold mb-4 text-center">üí∞ Monthly License Requirements</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h5 class="font-semibold mb-3">Required Licenses</h5>
                                    <div class="space-y-2">
                                        <template x-for="license in calculateImplementationCost().licenseBreakdown" :key="license.tool">
                                            <div class="flex justify-between items-center p-2 bg-white dark:bg-gray-700 rounded">
                                                <div>
                                                    <span class="font-medium text-sm" x-text="license.tool"></span>
                                                    <p class="text-xs text-gray-500" x-text="license.description"></p>
                                                </div>
                                                <span class="font-bold text-blue-600" x-text="'$' + license.cost"></span>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                                <div>
                                    <h5 class="font-semibold mb-3">Project Summary</h5>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span>Monthly Licensing Total</span>
                                            <span class="text-2xl font-bold text-blue-600" x-text="'$' + calculateImplementationCost().monthly.toLocaleString()"></span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span>Total Project Hours</span>
                                            <span class="text-2xl font-bold text-green-600" x-text="calculateImplementationCost().totalProjectHours + 'h'"></span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span>Project Complexity</span>
                                            <span class="px-3 py-1 rounded-full text-sm font-medium"
                                                  :class="getImplementationComplexity() <= 1.0 ? 'bg-green-100 text-green-800' : 
                                                         getImplementationComplexity() <= 1.5 ? 'bg-yellow-100 text-yellow-800' : 
                                                         getImplementationComplexity() <= 2.0 ? 'bg-orange-100 text-orange-800' : 
                                                         'bg-red-100 text-red-800'"
                                                  x-text="getImplementationComplexity() <= 1.0 ? 'Simple' : 
                                                         getImplementationComplexity() <= 1.5 ? 'Medium' : 
                                                         getImplementationComplexity() <= 2.0 ? 'Complex' : 
                                                         'Very Complex'">
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Use Cases Section -->
            <div x-show="activeSection === 'usecases'" class="space-y-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">üéØ Use Case Scenarios</h2>
                    <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                        Explore how different organization types can leverage Power Platform for their specific needs.
                    </p>
                </div>

                <!-- Use Case Cards -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <template x-for="usecase in useCases" :key="usecase.type">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden">
                            <div class="p-6 border-b border-gray-200 dark:border-gray-700" :style="'background: linear-gradient(135deg, ' + usecase.color + '20, ' + usecase.color + '10)'">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h3 class="text-xl font-bold" x-text="usecase.title"></h3>
                                        <p class="text-gray-600 dark:text-gray-400" x-text="usecase.description"></p>
                                    </div>
                                    <div class="text-3xl" x-text="usecase.icon"></div>
                                </div>
                            </div>
                            <div class="p-6">
                                <div class="space-y-6">
                                    <div>
                                        <h4 class="font-semibold mb-3">Common Scenarios</h4>
                                        <div class="space-y-2">
                                            <template x-for="scenario in usecase.scenarios" :key="scenario">
                                                <div class="flex items-start space-x-2">
                                                    <span class="text-green-500 mt-1">‚Ä¢</span>
                                                    <span class="text-sm" x-text="scenario"></span>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold mb-3">Recommended Products</h4>
                                        <div class="flex flex-wrap gap-2">
                                            <template x-for="product in usecase.products" :key="product">
                                                <span class="px-3 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200 text-xs rounded-full" x-text="product"></span>
                                            </template>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold mb-3">Estimated Cost Range</h4>
                                        <div class="text-lg font-bold text-primary" x-text="usecase.costRange"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-100 dark:bg-gray-800 mt-16 py-8">
            <div class="container mx-auto px-4 text-center">
                <p class="text-gray-600 dark:text-gray-400">
                    Microsoft Power Platform Analysis Tool ‚Ä¢ Built for comprehensive platform evaluation
                </p>
                <p class="text-sm text-gray-500 dark:text-gray-500 mt-2">
                    Last updated: January 2025 ‚Ä¢ Pricing subject to change
                </p>
            </div>
        </footer>
    </div>

    <script>
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        function powerPlatformTool() {
            return {
                activeSection: 'features',
                selectedLicenseProduct: 'powerapps',
                filters: {
                    product: '',
                    category: '',
                    license: ''
                },
                calculator: {
                    users: 50,
                    products: ['powerapps'],
                    licenseType: 'premium',
                    documentPages: 1000,
                    azurePages: 1000,
                    azureServiceType: 'standard',
                    productUsers: {
                        powerapps: 1,
                        powerautomate: 1,
                        powerbi: 1,
                        processmining: 1,
                        taskmining: 1,
                        powerpages: 1,
                        aibuilder: 1,
                        azureformrecognizer: 1,
                        powervirtualagents: 1,
                        copilotstudio: 1,
                        dataverse: 1
                    },
                    productLicenseType: {
                        powerapps: 'premium',
                        powerautomate: 'premium',
                        powerbi: 'pro',
                        processmining: 'standalone',
                        taskmining: 'premium',
                        powerpages: 'authenticated',
                        aibuilder: 'premium',
                        azureformrecognizer: 'standard',
                        powervirtualagents: 'sessions',
                        copilotstudio: 'sessions',
                        dataverse: 'premium'
                    }
                },
                tco: {
                    users: 50,
                    years: 3,
                    complexity: 'medium',
                    businessSize: 'medium'
                },

                sections: {
                    features: { name: 'Features', icon: 'üîç' },
                    ai: { name: 'AI & Copilot', icon: 'ü§ñ' },
                    mining: { name: 'Task vs Process Mining', icon: '‚õèÔ∏è' },
                    automation: { name: 'Task Automation', icon: 'üîß' },
                    security: { name: 'Security & Compliance', icon: 'üõ°Ô∏è' },
                    licensing: { name: 'Licensing & Pricing', icon: 'üí∞' },
                    roa: { name: 'ROA Calculator', icon: '‚ö°' },
                    comparison: { name: 'Platform Comparison', icon: 'üîÅ' },
                    tco: { name: 'TCO Calculator', icon: 'üìä' },
                    usecases: { name: 'Use Cases', icon: 'üéØ' }
                },

                productData: {
                    powerapps: {
                        name: 'Power Apps',
                        icon: 'üì±',
                        color: '#742774',
                        description: 'Build custom apps for mobile/web without extensive code',
                        detailedInfo: 'Canvas and model-driven apps with offline capability, role-based access, prebuilt templates, AI Builder support, and integration with Dataverse, SharePoint, Excel, SQL, Azure',
                        features: {
                            core: [
                                { name: 'Canvas Apps', description: 'Pixel-perfect custom interfaces', license: 'free' },
                                { name: 'Model-Driven Apps', description: 'Data-centric business applications', license: 'premium' },
                                { name: 'Component Framework', description: 'Custom controls and components', license: 'premium' },
                                { name: 'Responsive Design', description: 'Mobile-optimized layouts', license: 'free' }
                            ],
                            integration: [
                                { name: 'Dataverse Integration', description: 'Native database connectivity', license: 'premium' },
                                { name: '300+ Connectors', description: 'Pre-built API connections', license: 'free' },
                                { name: 'Custom Connectors', description: 'Build your own API connections', license: 'premium' },
                                { name: 'On-Premises Gateway', description: 'Connect to internal systems', license: 'premium' }
                            ],
                            ai: [
                                { name: 'AI Builder', description: 'Pre-built AI models', license: 'premium' },
                                { name: 'Copilot Studio', description: 'Natural language app building', license: 'premium' },
                                { name: 'Form Processing', description: 'Automated data extraction', license: 'premium' }
                            ]
                        }
                    },
                    powerpages: {
                        name: 'Power Pages',
                        icon: 'üåê',
                        color: '#0078D4',
                        description: 'Build external-facing websites',
                        features: {
                            core: [
                                { name: 'Low-Code Website Builder', description: 'Visual website creation', license: 'standalone' },
                                { name: 'Templates & Themes', description: 'Pre-built website designs', license: 'standalone' },
                                { name: 'Progressive Web Apps', description: 'App-like web experiences', license: 'standalone' }
                            ],
                            security: [
                                { name: 'External Authentication', description: 'Social and enterprise login', license: 'standalone' },
                                { name: 'Azure AD B2C', description: 'Customer identity management', license: 'standalone' },
                                { name: 'SSL Certificates', description: 'Built-in security certificates', license: 'standalone' }
                            ]
                        }
                    },
                    powerautomate: {
                        name: 'Power Automate',
                        icon: '‚ö°',
                        color: '#0066CC',
                        description: 'Automate workflows and processes',
                        features: {
                            core: [
                                { name: 'Cloud Flows', description: 'Automated business processes', license: 'free' },
                                { name: 'Desktop Flows (RPA)', description: 'Robotic Process Automation', license: 'premium' },
                                { name: 'Business Process Flows', description: 'Guided user experiences', license: 'premium' },
                                { name: 'Approvals', description: 'Built-in approval workflows', license: 'free' }
                            ],
                            ai: [
                                { name: 'AI-Powered Automation', description: 'Intelligent process automation', license: 'premium' },
                                { name: 'Process Mining', description: 'Discover automation opportunities from system logs', license: 'standalone' },
                                { name: 'Task Mining', description: 'Analyze user interactions and desktop activities', license: 'standalone' },
                                { name: 'AI Builder Integration', description: 'Pre-built AI models in flows', license: 'premium' }
                            ],
                            integration: [
                                { name: '400+ Premium Connectors', description: 'Enterprise system integrations', license: 'premium' },
                                { name: 'Custom Connectors', description: 'Build your own API connections', license: 'premium' },
                                { name: 'On-Premises Data Gateway', description: 'Connect to internal systems', license: 'premium' },
                                { name: 'SAP ERP Connector', description: 'Native SAP integration', license: 'premium' }
                            ],
                            governance: [
                                { name: 'Center of Excellence (CoE)', description: 'Governance and analytics toolkit', license: 'premium' },
                                { name: 'Data Loss Prevention (DLP)', description: 'Prevent data leakage across connectors', license: 'premium' },
                                { name: 'Admin Analytics', description: 'Usage and performance insights', license: 'premium' },
                                { name: 'Environment Management', description: 'Multi-environment deployment', license: 'premium' }
                            ]
                        }
                    },
                    powerbi: {
                        name: 'Power BI',
                        icon: 'üìä',
                        color: '#F2C811',
                        description: 'Business intelligence and analytics',
                        features: {
                            core: [
                                { name: 'Interactive Dashboards', description: 'Real-time data visualization', license: 'free' },
                                { name: 'Data Modeling', description: 'Advanced data relationships', license: 'premium' },
                                { name: 'Custom Visuals', description: 'Specialized chart types', license: 'free' }
                            ],
                            ai: [
                                { name: 'Q&A Natural Language', description: 'Ask questions in plain English', license: 'premium' },
                                { name: 'Auto ML', description: 'Automated machine learning', license: 'premium' }
                            ]
                        }
                    },
                    dataverse: {
                        name: 'Dataverse',
                        icon: 'üóÑÔ∏è',
                        color: '#004E8C',
                        description: 'Secure cloud database platform',
                        features: {
                            core: [
                                { name: 'Relational Database', description: 'Enterprise-grade data storage', license: 'premium' },
                                { name: 'Business Logic Layer', description: 'Server-side validation and workflows', license: 'premium' },
                                { name: 'Rich Data Types', description: 'Files, images, and complex data', license: 'premium' }
                            ]
                        }
                    },
                    copilotstudio: {
                        name: 'Copilot Studio',
                        icon: 'ü§ñ',
                        color: '#8661C5',
                        description: 'Build intelligent chatbots',
                        features: {
                            core: [
                                { name: 'No-Code Bot Building', description: 'Visual conversation design', license: 'standalone' },
                                { name: 'Natural Language Processing', description: 'Advanced AI understanding', license: 'standalone' },
                                { name: 'Multi-Channel Deployment', description: 'Teams, web, mobile integration', license: 'standalone' }
                            ],
                            ai: [
                                { name: 'Generative AI Answers', description: 'AI-powered responses from knowledge base', license: 'standalone' },
                                { name: 'Bot Analytics', description: 'Usage and conversation insights', license: 'standalone' },
                                { name: 'Intent Recognition', description: 'Automatic understanding of user requests', license: 'standalone' }
                            ],
                            integration: [
                                { name: 'Power Platform Integration', description: 'Connect to Power Apps and Automate', license: 'standalone' },
                                { name: 'Third-party Connectors', description: 'Integrate with external services', license: 'standalone' },
                                { name: 'Handoff to Human Agents', description: 'Seamless escalation to live support', license: 'standalone' }
                            ]
                        }
                    },
                    processmining: {
                        name: 'Process Mining',
                        icon: '‚õèÔ∏è',
                        color: '#FF8C00',
                        description: 'Discover and optimize business processes',
                        features: {
                            core: [
                                { name: 'Process Discovery', description: 'Automatically map business processes from system logs', license: 'standalone' },
                                { name: 'Process Analytics', description: 'Deep insights into process performance', license: 'standalone' },
                                { name: 'Process Visualization', description: 'Interactive process maps and flowcharts', license: 'standalone' },
                                { name: 'Variant Analysis', description: 'Identify different process execution paths', license: 'standalone' }
                            ],
                            ai: [
                                { name: 'AI-Powered Insights', description: 'Machine learning process recommendations', license: 'standalone' },
                                { name: 'Anomaly Detection', description: 'Identify unusual process patterns', license: 'standalone' },
                                { name: 'Predictive Analytics', description: 'Forecast process bottlenecks', license: 'standalone' }
                            ],
                            integration: [
                                { name: 'Multi-System Data Sources', description: 'Connect to ERP, CRM, and other systems', license: 'standalone' },
                                { name: 'Power Automate Integration', description: 'Feed insights into automation workflows', license: 'standalone' },
                                { name: 'Real-time Monitoring', description: 'Live process performance tracking', license: 'standalone' }
                            ]
                        }
                    },
                    taskmining: {
                        name: 'Task Mining',
                        icon: 'üëÅÔ∏è',
                        color: '#107C10',
                        description: 'Analyze user desktop interactions and manual tasks',
                        features: {
                            core: [
                                { name: 'Desktop Recording', description: 'Capture user interactions across applications', license: 'premium' },
                                { name: 'Task Pattern Recognition', description: 'Identify repetitive manual tasks', license: 'premium' },
                                { name: 'User Journey Mapping', description: 'Visualize complete user workflows', license: 'premium' },
                                { name: 'Time Analysis', description: 'Measure time spent on different activities', license: 'premium' }
                            ],
                            ai: [
                                { name: 'Automation Recommendations', description: 'AI suggestions for RPA opportunities', license: 'premium' },
                                { name: 'Process Clustering', description: 'Group similar tasks and workflows', license: 'premium' },
                                { name: 'Optimization Insights', description: 'Identify efficiency improvement opportunities', license: 'premium' }
                            ],
                            integration: [
                                { name: 'Power Automate RPA', description: 'Direct integration with desktop automation', license: 'premium' },
                                { name: 'Process Mining Connection', description: 'Link task-level and process-level insights', license: 'premium' },
                                { name: 'Privacy Controls', description: 'User consent and data protection features', license: 'premium' }
                            ]
                        }
                    },
                    aibuilder: {
                        name: 'AI Builder',
                        icon: 'üß†',
                        color: '#8661C5',
                        description: 'Add AI capabilities to apps and flows',
                        features: {
                            core: [
                                { name: 'Pre-built AI Models', description: 'Ready-to-use AI for common scenarios', license: 'premium' },
                                { name: 'Custom Model Training', description: 'Train AI models with your own data', license: 'premium' },
                                { name: 'Form Processing', description: 'Extract data from documents and forms', license: 'premium' },
                                { name: 'Text Analytics', description: 'Sentiment analysis and language detection', license: 'premium' }
                            ],
                            ai: [
                                { name: 'Object Detection', description: 'Identify objects in images', license: 'premium' },
                                { name: 'Prediction Models', description: 'Forecast outcomes based on historical data', license: 'premium' },
                                { name: 'Business Card Reader', description: 'Extract contact information from business cards', license: 'premium' }
                            ],
                            integration: [
                                { name: 'Power Apps Integration', description: 'Embed AI directly in applications', license: 'premium' },
                                { name: 'Power Automate Flows', description: 'Use AI in automated workflows', license: 'premium' },
                                { name: 'Custom Connectors', description: 'Connect to external AI services', license: 'premium' }
                            ]
                        }
                    }
                },

                securityCategories: [
                    { name: 'Identity & Access', icon: 'üîê', description: 'Azure AD integration and role-based security' },
                    { name: 'Data Protection', icon: 'üõ°Ô∏è', description: 'Encryption, DLP, and privacy controls' },
                    { name: 'Compliance', icon: 'üìã', description: 'Industry certifications and audit trails' },
                    { name: 'Infrastructure', icon: 'üèóÔ∏è', description: 'Enterprise-grade hosting and availability' }
                ],

                securityDetails: {
                    identity_access: [
                        { name: 'Azure Active Directory Integration', description: 'Single sign-on and multi-factor authentication', products: ['All Products'] },
                        { name: 'Role-Based Access Control', description: 'Granular permissions and security roles', products: ['Power Apps', 'Power BI', 'Dataverse'] },
                        { name: 'Conditional Access', description: 'Context-aware access policies', products: ['All Products'] },
                        { name: 'External Identity Support', description: 'B2B and B2C authentication', products: ['Power Pages'] }
                    ],
                    data_protection: [
                        { name: 'Data Encryption at Rest', description: 'AES-256 encryption for stored data', products: ['All Products'] },
                        { name: 'Data Encryption in Transit', description: 'TLS 1.2+ for all communications', products: ['All Products'] },
                        { name: 'Data Loss Prevention', description: 'Prevent sensitive data sharing', products: ['All Products'] },
                        { name: 'Row-Level Security', description: 'User-specific data access controls', products: ['Power BI', 'Dataverse'] }
                    ],
                    compliance: [
                        { name: 'Audit Logging', description: 'Comprehensive activity tracking', products: ['All Products'] },
                        { name: 'Data Residency', description: 'Geographic data storage controls', products: ['All Products'] },
                        { name: 'Retention Policies', description: 'Automated data lifecycle management', products: ['All Products'] },
                        { name: 'eDiscovery Support', description: 'Legal hold and search capabilities', products: ['All Products'] }
                    ],
                    infrastructure: [
                        { name: '99.9% SLA', description: 'Enterprise-grade availability guarantee', products: ['All Products'] },
                        { name: 'Global Data Centers', description: 'Worldwide infrastructure presence', products: ['All Products'] },
                        { name: 'Disaster Recovery', description: 'Built-in backup and failover', products: ['All Products'] },
                        { name: 'Network Security', description: 'DDoS protection and network isolation', products: ['All Products'] }
                    ]
                },

                complianceCerts: [
                    { name: 'SOC 2', icon: 'üèõÔ∏è', description: 'Security controls certification' },
                    { name: 'ISO 27001', icon: 'üåê', description: 'Information security management' },
                    { name: 'GDPR', icon: 'üá™üá∫', description: 'European privacy regulation' },
                    { name: 'HIPAA', icon: 'üè•', description: 'Healthcare data protection' },
                    { name: 'FedRAMP', icon: 'üá∫üá∏', description: 'US government security standard' },
                    { name: 'PCI DSS', icon: 'üí≥', description: 'Payment card data security' }
                ],

                licensingData: {
                    powerapps: {
                        name: 'Power Apps',
                        icon: 'üì±',
                        description: 'Custom business applications',
                        plans: [
                            { name: 'Developer Plan (Free)', description: 'Full functionality in personal dev environment', pricing: 'Free', features: 'Individual use, not for production', limitations: 'Personal development only' },
                            { name: 'Per App Plan', description: 'Use 1 app/1 portal per user', pricing: '~$5/user/app/month', features: 'Single app access', limitations: 'Limited to one app per user' },
                            { name: 'Per User Plan (Premium)', description: 'Unlimited apps/portals per user', pricing: '~$20/user/month', features: 'Unlimited apps, premium connectors', limitations: 'None' },
                            { name: 'Pay-as-you-go', description: 'Charges per app and user via Azure', pricing: 'Variable via Azure', features: 'Flexible billing', limitations: 'Requires Azure subscription' }
                        ]
                    },
                    powerautomate: {
                        name: 'Power Automate',
                        icon: '‚ö°',
                        description: 'Workflow automation',
                        plans: [
                            { name: 'Free', description: 'Limited cloud flows for personal use', pricing: 'Free', features: 'Basic flows, standard connectors', limitations: 'Limited to personal use' },
                            { name: 'Per User Plan (Premium)', description: 'Unlimited flows', pricing: '~$15/user/month', features: 'Unlimited flows, premium connectors', limitations: 'None' },
                            { name: 'Per Flow Plan', description: 'For organization-wide flows', pricing: '~$100/flow/month', features: 'Up to 5 users per flow', limitations: 'User limit per flow' },
                            { name: 'Pay-as-you-go', description: 'Based on flow runs (metered)', pricing: 'Per execution', features: 'Azure-based billing', limitations: 'Requires Azure subscription' },
                            { name: 'RPA Attended', description: 'Desktop automation with user', pricing: '~$40/user/month', features: 'User-guided automation, Task Mining included', limitations: 'Requires user presence' },
                            { name: 'RPA Unattended', description: 'Desktop automation without user', pricing: '~$150/bot/month', features: 'Fully automated bots, Task Mining included', limitations: 'Higher cost per bot' }
                        ]
                    },
                    processmining: {
                        name: 'Process Mining',
                        icon: '‚õèÔ∏è',
                        description: 'Discover and analyze business processes',
                        plans: [
                            { name: 'Process Mining Standalone', description: 'Full process mining capabilities', pricing: '~$5,000/environment/month', features: 'Unlimited process analysis, dashboard, connectors', limitations: 'Environment-based pricing' },
                            { name: 'Process Mining with Power Automate Premium', description: 'Included with premium automation plans', pricing: 'Included in PA Premium', features: 'Basic process analysis, limited data sources', limitations: 'Limited compared to standalone' },
                            { name: 'Process Mining Pay-as-you-go', description: 'Azure consumption-based billing', pricing: 'Per GB processed via Azure', features: 'Flexible usage-based pricing', limitations: 'Requires Azure subscription and monitoring' }
                        ]
                    },
                    taskmining: {
                        name: 'Task Mining',
                        icon: 'üëÅÔ∏è',
                        description: 'Analyze user desktop interactions',
                        plans: [
                            { name: 'Task Mining with RPA Attended', description: 'Included with attended RPA licenses', pricing: 'Included (~$40/user/month)', features: 'Desktop recording, process discovery', limitations: 'Limited to attended automation users' },
                            { name: 'Task Mining with RPA Unattended', description: 'Included with unattended RPA licenses', pricing: 'Included (~$150/bot/month)', features: 'Advanced analytics, ML insights', limitations: 'Limited to unattended automation deployments' },
                            { name: 'Task Mining Standalone', description: 'Dedicated task mining without RPA', pricing: '~$150/user/month', features: 'Full task mining capabilities, advanced analytics', limitations: 'Higher cost without RPA bundle' },
                            { name: 'Task Mining Pay-per-session', description: 'Recording session-based billing', pricing: '~$10/recording session', features: 'Flexible usage-based pricing', limitations: 'Can become expensive with heavy usage' }
                        ]
                    },
                    powerbi: {
                        name: 'Power BI',
                        icon: 'üìä',
                        description: 'Business intelligence',
                        plans: [
                            { name: 'Free', description: 'Build & view reports in Power BI Desktop', pricing: 'Free', features: 'Personal reports and dashboards', limitations: 'Cannot share with others' },
                            { name: 'Pro', description: 'Share reports, collaborate', pricing: '~$10/user/month', features: 'Sharing, collaboration, 10GB storage', limitations: '1GB dataset limit' },
                            { name: 'Premium Per User (PPU)', description: 'Enhanced AI, big data support', pricing: '~$20/user/month', features: 'Large datasets, AI features, dataflows', limitations: 'Per-user licensing' },
                            { name: 'Premium Capacity', description: 'Organizational capacity, high-performance', pricing: 'Starts ~$4,995/month', features: 'Dedicated capacity, unlimited sharing', limitations: 'High minimum cost' },
                            { name: 'Fabric', description: 'Advanced data experiences in Microsoft Fabric', pricing: 'Capacity-based', features: 'Complete analytics platform', limitations: 'Complex pricing model' }
                        ]
                    },
                    powerpages: {
                        name: 'Power Pages',
                        icon: 'üåê',
                        description: 'External websites',
                        plans: [
                            { name: 'Trial (Free)', description: '30-day full feature access', pricing: 'Free', features: 'Full functionality', limitations: '30-day trial, one portal' },
                            { name: 'Authenticated Users Plan', description: 'Pay per user login or monthly active users', pricing: 'Starts ~$200/100 logins/month', features: 'User-based billing', limitations: 'Per login charges' },
                            { name: 'Anonymous Users Plan', description: 'Pay per page view', pricing: 'Starts ~$75/500k page views/month', features: 'Page view-based billing', limitations: 'Per page view charges' },
                            { name: 'Pay-as-you-go', description: 'Metered usage through Azure', pricing: 'Variable via Azure', features: 'Flexible Azure billing', limitations: 'Requires Azure subscription' }
                        ]
                    },
                    powervirtualagents: {
                        name: 'Power Virtual Agents',
                        icon: 'ü§ñ',
                        description: 'AI-powered chatbots',
                        plans: [
                            { name: 'Trial (Free)', description: 'Full functionality, limited duration', pricing: 'Free', features: 'Complete bot capabilities', limitations: '30-day trial' },
                            { name: 'PVA Standalone Plan', description: 'Unlimited sessions', pricing: '~$200/10,000 sessions/month', features: 'Full bot features, analytics', limitations: 'Session-based billing' },
                            { name: 'Pay-as-you-go', description: 'Based on sessions used', pricing: 'Per session via Azure', features: 'Azure meter pricing', limitations: 'Requires Azure subscription' }
                        ]
                    },
                    azureformrecognizer: {
                        name: 'Azure Form Recognizer',
                        icon: 'üü¶',
                        description: 'Azure AI Document Intelligence',
                        plans: [
                            { name: 'Standard Processing', description: 'Standard document processing', pricing: '$0.01/page', features: 'Text, tables, key-value extraction', limitations: 'Requires Azure subscription' },
                            { name: 'Document Classification', description: 'Document classification only', pricing: '$0.002/page', features: 'Document categorization', limitations: 'Classification only' },
                            { name: 'Custom Training', description: 'Train custom models', pricing: 'Free', features: 'Custom model development', limitations: 'Processing charges apply' },
                            { name: 'Premium Features', description: 'Advanced layout analysis', pricing: 'Variable per feature', features: 'Layout, structure analysis', limitations: 'Feature-specific pricing' }
                        ]
                    },
                    dataverse: {
                        name: 'Dataverse',
                        icon: 'üóÑÔ∏è',
                        description: 'Cloud database platform',
                        plans: [
                            { name: 'Included with Premium', description: 'Included in Power Apps/Automate Premium', pricing: 'Included', features: 'Basic storage and operations', limitations: 'Limited storage capacity' },
                            { name: 'Additional Capacity', description: 'Extra database storage', pricing: '~$40/GB/month', features: 'Extended storage', limitations: 'Additional cost per GB' },
                            { name: 'Database Capacity', description: 'Additional database capacity units', pricing: '~$60/capacity unit/month', features: 'Enhanced performance', limitations: 'Complex capacity planning' }
                        ]
                    },
                    aibuilder: {
                        name: 'AI Builder',
                        icon: 'üß†',
                        description: 'AI capabilities and models',
                        plans: [
                            { name: 'Included Credits', description: 'Credits included in Premium plans', pricing: 'Included', features: 'Limited AI operations', limitations: 'Credit-based usage' },
                            { name: 'Additional Credits', description: 'Extra AI Builder credits', pricing: '~$500/1M credits', features: 'Extended AI capabilities', limitations: 'Per-credit billing' },
                            { name: 'Pay-as-you-go', description: 'Azure-based AI Builder usage', pricing: 'Per operation via Azure', features: 'Flexible AI billing', limitations: 'Requires Azure subscription' }
                        ]
                    }
                },

                comparisonData: [
                    {
                        feature: 'Development Time',
                        powerPlatform: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Days to weeks' },
                        custom: { rating: '‚≠ê‚≠ê', note: 'Months to years' },
                        wordpress: { rating: '‚≠ê‚≠ê‚≠ê', note: 'Weeks to months' },
                        cloud: { rating: '‚≠ê‚≠ê', note: 'Months' },
                        lowCode: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Weeks' }
                    },
                    {
                        feature: 'Initial Cost',
                        powerPlatform: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê', note: '$300-500/mo' },
                        custom: { rating: '‚≠ê‚≠ê', note: '$50k-200k' },
                        wordpress: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', note: '$50-500/mo' },
                        cloud: { rating: '‚≠ê‚≠ê‚≠ê', note: '$1k-5k/mo' },
                        lowCode: { rating: '‚≠ê‚≠ê‚≠ê', note: '$1k-3k/mo' }
                    },
                    {
                        feature: 'Maintenance',
                        powerPlatform: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Minimal' },
                        custom: { rating: '‚≠ê‚≠ê', note: 'High' },
                        wordpress: { rating: '‚≠ê‚≠ê‚≠ê', note: 'Medium' },
                        cloud: { rating: '‚≠ê‚≠ê‚≠ê', note: 'Medium' },
                        lowCode: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Low' }
                    },
                    {
                        feature: 'Security',
                        powerPlatform: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Enterprise grade' },
                        custom: { rating: '‚≠ê‚≠ê‚≠ê', note: 'Variable' },
                        wordpress: { rating: '‚≠ê‚≠ê', note: 'Plugin dependent' },
                        cloud: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Good with setup' },
                        lowCode: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Platform dependent' }
                    },
                    {
                        feature: 'Scalability',
                        powerPlatform: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Auto-scaling' },
                        custom: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Custom scaling' },
                        wordpress: { rating: '‚≠ê‚≠ê‚≠ê', note: 'Limited' },
                        cloud: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Highly scalable' },
                        lowCode: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Platform limits' }
                    },
                    {
                        feature: 'Integration',
                        powerPlatform: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', note: '400+ connectors' },
                        custom: { rating: '‚≠ê‚≠ê‚≠ê', note: 'Custom APIs' },
                        wordpress: { rating: '‚≠ê‚≠ê‚≠ê', note: 'Plugin ecosystem' },
                        cloud: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê', note: 'API-first' },
                        lowCode: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Built-in connectors' }
                    },
                    {
                        feature: 'Process Mining',
                        powerPlatform: { rating: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', note: 'Native support' },
                        custom: { rating: '‚≠ê‚≠ê', note: 'Custom build' },
                        wordpress: { rating: '‚≠ê', note: 'Not available' },
                        cloud: { rating: '‚≠ê‚≠ê‚≠ê', note: 'Third-party tools' },
                        lowCode: { rating: '‚≠ê‚≠ê', note: 'Limited options' }
                    }
                ],

                powerPlatformCosts: [
                    { item: 'Power Apps (per user)', cost: '$20/mo' },
                    { item: 'Power Automate', cost: '$15/mo' },
                    { item: 'Power BI Pro', cost: '$10/mo' },
                    { item: 'Process Mining (shared)', cost: '$50/mo' },
                    { item: 'Dataverse storage', cost: '$40/GB' },
                    { item: 'Support & training', cost: '$50/mo' }
                ],

                traditionalCosts: [
                    { item: 'Development team (3-6 months)', cost: '$75k' },
                    { item: 'Infrastructure hosting', cost: '$300/mo' },
                    { item: 'Database licensing', cost: '$400/mo' },
                    { item: 'Process analysis tools', cost: '$800/mo' },
                    { item: 'Security & compliance', cost: '$400/mo' },
                    { item: 'Ongoing maintenance', cost: '$1800/mo' }
                ],

                useCases: [
                    {
                        type: 'sme',
                        title: 'Small & Medium Enterprises (SMEs)',
                        icon: 'üè¢',
                        color: '#0078D4',
                        description: 'Fast-growing businesses needing flexible, cost-effective solutions',
                        scenarios: [
                            'CRM & customer engagement apps',
                            'Onboarding workflows for new employees',
                            'Inventory and invoice management systems',
                            'Financial dashboards and reporting',
                            'Task Mining to discover inefficiencies'
                        ],
                        products: ['Power Apps', 'Power Automate', 'Power BI', 'Task Mining'],
                        costRange: '$500-2,000/month',
                        sampleUseCase: 'Build a complete customer management system with automated follow-ups and real-time sales dashboards'
                    },
                    {
                        type: 'startup',
                        title: 'Startups & Scale-ups',
                        icon: 'üöÄ',
                        color: '#8661C5',
                        description: 'Rapid prototyping and lean operations for growing companies',
                        scenarios: [
                            'Build MVPs fast for market validation',
                            'Feedback loops via web forms and Power Pages',
                            'Pitch decks and investor analytics in Power BI',
                            'Copilot-generated apps for rapid iteration',
                            'Team collaboration and project management tools'
                        ],
                        products: ['Power Apps', 'Power BI', 'Power Pages', 'Copilot Studio'],
                        costRange: '$200-1,000/month',
                        sampleUseCase: 'Create an investor portal with real-time metrics and automated report generation'
                    },
                    {
                        type: 'ngo',
                        title: 'Non-Profit Organizations',
                        icon: '‚ù§Ô∏è',
                        color: '#107C10',
                        description: 'Mission-focused applications with budget constraints and social impact goals',
                        scenarios: [
                            'Volunteer tracking and management apps',
                            'Donation workflows and donor analytics',
                            'Event registration via Power Pages',
                            'Impact reports to donors and boards',
                            'Grant application management systems'
                        ],
                        products: ['Power Apps', 'Power Automate', 'Power Pages'],
                        costRange: '$100-500/month (Nonprofit pricing available)',
                        sampleUseCase: 'Volunteer coordination system with automated scheduling and impact tracking dashboards'
                    },
                    {
                        type: 'enterprise',
                        title: 'Enterprise Organizations',
                        icon: 'üèõÔ∏è',
                        color: '#D13438',
                        description: 'Large-scale digital transformation with comprehensive automation and analytics',
                        scenarios: [
                            'End-to-end automation across departments',
                            'Customer portals with Power Pages integration',
                            'Compliance analytics via Power BI Premium',
                            'Process discovery and redesign with Process Mining',
                            'AI bots integrated into Microsoft Teams',
                            'Advanced governance and security implementations'
                        ],
                        products: ['Entire Power Platform', 'Process Mining', 'Task Mining', 'Azure Integrations', 'Premium Features'],
                        costRange: '$5,000-50,000+/month',
                        sampleUseCase: 'Complete digital transformation with automated workflows, customer portals, and real-time executive dashboards'
                    }
                ],

                get filteredProducts() {
                    let products = this.productData;
                    
                    if (this.filters.product) {
                        products = { [this.filters.product]: products[this.filters.product] };
                    }
                    
                    return products;
                },

                getProductCost(product) {
                    const baseCosts = {
                        powerapps: { premium: 20, per_app: 5, standalone: 20 },
                        powerautomate: { premium: 15, per_app: 15, standalone: 15 },
                        processmining: { premium: 5000, per_app: 5000, standalone: 5000 },
                        taskmining: { premium: 150, per_app: 150, standalone: 150 },
                        powerbi: { premium: 10, per_app: 10, standalone: 20 },
                        powerpages: { premium: 200, per_app: 200, standalone: 200 },
                        dataverse: { premium: 40, per_app: 40, standalone: 40 },
                        powervirtualagents: { premium: 200, per_app: 200, standalone: 200 },
                        aibuilder: { premium: 500, per_app: 500, standalone: 500 }
                    };

                    if (baseCosts[product]) {
                        const cost = baseCosts[product][this.calculator.licenseType] || 0;
                        if (['powerpages', 'dataverse', 'powervirtualagents', 'aibuilder', 'processmining'].includes(product)) {
                            return cost; // Per-site, per-GB, per-session, or per-environment pricing
                        } else if (product === 'taskmining') {
                            return cost * Math.min(this.calculator.users, 10); // Task mining typically limited users
                        } else {
                            return cost * this.calculator.users;
                        }
                    }
                    return 0;
                },

                calculateLicenseCost() {
                    let totalCost = 0;
                    
                    for (const product of this.calculator.products) {
                        totalCost += this.getProductCost(product);
                    }
                    
                    return totalCost;
                },

                calculateTCO(platform) {
                    const complexityMultipliers = {
                        simple: 1,
                        medium: 1.5,
                        complex: 2.5
                    };

                    const sizeMultipliers = {
                        small: 0.8,
                        medium: 1,
                        large: 1.3
                    };

                    const multiplier = complexityMultipliers[this.tco.complexity] * sizeMultipliers[this.tco.businessSize];

                    if (platform === 'powerplatform') {
                        const initial = 5000 * multiplier;
                        const annual = (this.tco.users * 300) * multiplier;
                        const maintenance = 2000 * multiplier;
                        const total = initial + (annual + maintenance) * this.tco.years;

                        return { initial, annual, maintenance, total };
                    } else {
                        const initial = 40000 * multiplier;  // More realistic initial development cost
                        const annual = 8000 * multiplier;    // More realistic annual infrastructure
                        const maintenance = 15000 * multiplier; // More realistic maintenance costs
                        const total = initial + (annual + maintenance) * this.tco.years;

                        return { initial, annual, maintenance, total };
                    }
                },

                getAdvancedProductCost(product) {
                    // Microsoft Official Pricing with specific tiers
                    const officialPricing = {
                        powerapps: { 
                            per_app: 5,    // Per app per user/month
                            premium: 20    // Premium per user/month
                        },
                        powerautomate: { 
                            premium: 15,        // Premium per user/month
                            rpa_attended: 40,   // RPA Attended per user/month (includes Task Mining)
                            rpa_unattended: 150 // RPA Unattended per bot/month (includes Task Mining)
                        },
                        powerbi: { 
                            pro: 10,      // Pro per user/month
                            premium: 20   // Premium Per User/month
                        },
                        processmining: { 
                            standalone: 5000  // Process Mining per environment/month
                        },
                        powerpages: { 
                            authenticated: 200,  // Base cost for authenticated users
                            anonymous: 75        // Base cost for anonymous users
                        },
                        powervirtualagents: {
                            sessions: 200  // Per 10k sessions/month
                        },
                        dataverse: {
                            premium: 40,      // Additional storage per GB/month
                            standalone: 40
                        },
                        aibuilder: {
                            premium: 0,       // Included credits (5,000/month)
                            standalone: 500   // Additional 1M credits/month
                        },
                        azureformrecognizer: {
                            standard: 0,          // Will be calculated separately
                            classification: 0     // Will be calculated separately
                        },
                        copilotstudio: {
                            sessions: 200,    // Per 10k sessions/month
                            standalone: 200
                        }
                    };

                    const users = this.calculator.productUsers[product] || 1;
                    const licenseType = this.calculator.productLicenseType[product] || 'premium';
                    
                    // Special handling for AI Builder based on document pages
                    if (product === 'aibuilder') {
                        const creditsNeeded = (this.calculator.documentPages || 1000) * 5;
                        if (creditsNeeded <= 5000) {
                            return 0; // Covered by included credits
                        } else {
                            return Math.ceil((creditsNeeded - 5000) / 1000000 * 500);
                        }
                    }
                    
                    // Special handling for Azure Form Recognizer
                    if (product === 'azureformrecognizer') {
                        const pages = this.calculator.azurePages || 1000;
                        const pricePerPage = this.calculator.azureServiceType === 'classification' ? 0.002 : 0.01;
                        return Math.round(pages * pricePerPage);
                    }
                    
                    if (officialPricing[product] && officialPricing[product][licenseType] !== undefined) {
                        const baseCost = officialPricing[product][licenseType];
                        
                        // Products with fixed pricing per environment/site/session
                        if (['processmining', 'powerpages', 'powervirtualagents', 'copilotstudio', 'dataverse'].includes(product)) {
                            return baseCost;
                        }
                        
                        // Per-user or per-bot pricing
                        return baseCost * users;
                    }
                    
                    // Fallback for unmapped products
                    console.log('No pricing found for product:', product, 'with license type:', licenseType);
                    return 0;
                },

                calculateAdvancedLicenseCost() {
                    let totalCost = 0;
                    
                    for (const product of this.calculator.products) {
                        totalCost += this.getAdvancedProductCost(product);
                    }
                    
                    return totalCost;
                },

                getCalculatorProducts() {
                    // Include AI Builder and Azure Form Recognizer for document processing comparison
                    const products = Object.keys(this.licensingData).filter(product => product !== 'taskmining');
                    // Add Azure Form Recognizer as a comparison option
                    if (!products.includes('azureformrecognizer')) {
                        products.push('azureformrecognizer');
                    }
                    return products.slice(0, 8);
                },

                getLicenseTiers(product) {
                    const tiers = {
                        powerapps: [
                            { value: 'per_app', name: 'Per App ($5/user/app)' },
                            { value: 'premium', name: 'Premium ($20/user)' }
                        ],
                        powerautomate: [
                            { value: 'premium', name: 'Premium ($15/user)' },
                            { value: 'rpa_attended', name: 'RPA Attended ($40/user)' },
                            { value: 'rpa_unattended', name: 'RPA Unattended ($150/bot)' }
                        ],
                        powerbi: [
                            { value: 'pro', name: 'Pro ($10/user)' },
                            { value: 'premium', name: 'Premium Per User ($20/user)' }
                        ],
                        processmining: [
                            { value: 'standalone', name: 'Standalone ($5,000/environment)' }
                        ],
                        powerpages: [
                            { value: 'authenticated', name: 'Authenticated Users ($200/100 logins)' },
                            { value: 'anonymous', name: 'Anonymous Users ($75/500k views)' }
                        ],
                        powervirtualagents: [
                            { value: 'sessions', name: 'Sessions ($200/10k sessions)' }
                        ]
                    };
                    
                    return tiers[product] || [{ value: 'premium', name: 'Premium' }];
                },

                getLicenseCapabilities(product, licenseType) {
                    const capabilities = {
                        powerapps: {
                            per_app: ['Access to 1 app per user', 'Standard connectors', 'Basic Dataverse'],
                            premium: ['Unlimited apps', 'Premium connectors', 'Full Dataverse', 'AI Builder credits']
                        },
                        powerautomate: {
                            premium: ['Unlimited cloud flows', 'Premium connectors', 'Business process flows', 'Basic Task Mining included'],
                            rpa_attended: ['Desktop automation with user', 'Advanced Task Mining included', 'Attended bots'],
                            rpa_unattended: ['Fully automated bots', 'Advanced Task Mining included', 'Unattended automation']
                        },
                        powerbi: {
                            pro: ['Report sharing', '10GB storage', '1GB datasets', 'Basic collaboration'],
                            premium: ['Large datasets', 'AI features', 'Dataflows', 'Enhanced performance']
                        },
                        processmining: {
                            standalone: ['Full process analysis', 'Unlimited data sources', 'Advanced dashboards', 'Process optimization']
                        },
                        powerpages: {
                            authenticated: ['User authentication', 'Secure access', 'User management'],
                            anonymous: ['Public access', 'High traffic support', 'SEO optimization']
                        },
                        powervirtualagents: {
                            sessions: ['Unlimited bot conversations', 'Multi-channel deployment', 'Analytics']
                        }
                    };
                    
                    return capabilities[product]?.[licenseType] || [];
                },

                // ROA Calculator properties
                roa: {
                    processType: 'data_entry',
                    usersAffected: 10,
                    timePerTask: 30,
                    tasksPerDay: 20,
                    workingDaysPerYear: 250,
                    hourlyRate: 35,
                    automationEfficiency: 80,
                    errorReduction: 90
                },

                calculateROA() {
                    const minutesPerDay = this.roa.timePerTask * this.roa.tasksPerDay * this.roa.usersAffected;
                    const hoursPerDay = (minutesPerDay * this.roa.automationEfficiency / 100) / 60;
                    const hoursPerYear = hoursPerDay * this.roa.workingDaysPerYear;
                    const equivalentFTE = hoursPerYear / 2080; // Standard work year hours
                    
                    // Time efficiency calculations
                    const efficiencyGainPercentage = this.roa.automationEfficiency;
                    const errorReductionPercentage = this.roa.errorReduction;
                    const timeReductionMinutes = (this.roa.timePerTask * this.roa.automationEfficiency) / 100;
                    
                    // Process improvements
                    const processAccuracy = 100 - ((100 - this.roa.errorReduction) * 0.1); // Improved process accuracy
                    const availabilityIncrease = 300; // 24/7 vs 8-hour availability
                    
                    return {
                        hoursPerDay: hoursPerDay,
                        hoursPerYear: hoursPerYear,
                        equivalentFTE: equivalentFTE,
                        efficiencyGain: efficiencyGainPercentage,
                        errorReduction: errorReductionPercentage,
                        timeReduction: timeReductionMinutes,
                        processAccuracy: processAccuracy,
                        availabilityIncrease: availabilityIncrease,
                        automatedTasksPerDay: this.roa.tasksPerDay * this.roa.usersAffected
                    };
                },

                getProcessBenefits(processType) {
                    const benefits = {
                        data_entry: [
                            { name: 'Elimination of Manual Data Entry', description: 'Automated data capture from multiple sources', impact: '90% time reduction' },
                            { name: 'Real-time Data Validation', description: 'Instant error checking and correction', impact: '95% error reduction' },
                            { name: 'Consistent Data Formatting', description: 'Standardized data structure across systems', impact: '100% consistency' },
                            { name: 'Audit Trail Creation', description: 'Automatic logging of all data changes', impact: 'Full compliance' }
                        ],
                        approvals: [
                            { name: 'Automated Routing', description: 'Smart routing based on business rules', impact: '70% faster approvals' },
                            { name: 'Parallel Processing', description: 'Multiple approvers can act simultaneously', impact: '50% time reduction' },
                            { name: 'Escalation Management', description: 'Automatic escalation for overdue items', impact: '0% missed deadlines' },
                            { name: 'Mobile Accessibility', description: 'Approve from anywhere, any device', impact: '24/7 availability' }
                        ],
                        reporting: [
                            { name: 'Real-time Data Refresh', description: 'Live data connections and updates', impact: 'Always current data' },
                            { name: 'Automated Distribution', description: 'Scheduled report delivery to stakeholders', impact: '90% time savings' },
                            { name: 'Interactive Dashboards', description: 'Self-service analytics for users', impact: 'Reduced support requests' },
                            { name: 'Exception Alerts', description: 'Proactive notifications for anomalies', impact: 'Faster response times' }
                        ],
                        customer_service: [
                            { name: '24/7 Self-Service', description: 'Automated customer support via chatbots', impact: '60% case reduction' },
                            { name: 'Instant Case Routing', description: 'Smart assignment to right agent', impact: '40% faster resolution' },
                            { name: 'Knowledge Base Integration', description: 'Automatic suggestions and solutions', impact: '50% first-call resolution' },
                            { name: 'Sentiment Analysis', description: 'Automatic priority based on customer mood', impact: 'Improved satisfaction' }
                        ],
                        hr_onboarding: [
                            { name: 'Digital Document Collection', description: 'Paperless forms and e-signatures', impact: '80% faster processing' },
                            { name: 'Automated Provisioning', description: 'Account creation and system access', impact: '95% error reduction' },
                            { name: 'Personalized Workflows', description: 'Role-based onboarding processes', impact: 'Better experience' },
                            { name: 'Progress Tracking', description: 'Real-time onboarding status monitoring', impact: 'Full visibility' }
                        ],
                        invoice_processing: [
                            { name: 'OCR Data Extraction', description: 'Automatic data capture from invoices', impact: '85% time savings' },
                            { name: 'Three-way Matching', description: 'Automated PO, receipt, and invoice matching', impact: '90% accuracy' },
                            { name: 'Exception Handling', description: 'Smart routing of discrepancies', impact: 'Faster resolution' },
                            { name: 'Vendor Communication', description: 'Automated status updates and queries', impact: 'Better relationships' }
                        ],
                        inventory_management: [
                            { name: 'Real-time Stock Monitoring', description: 'Live inventory level tracking', impact: 'No stockouts' },
                            { name: 'Automated Reordering', description: 'Smart replenishment based on demand', impact: '30% cost reduction' },
                            { name: 'Predictive Analytics', description: 'Demand forecasting and planning', impact: 'Optimized inventory' },
                            { name: 'Barcode Integration', description: 'Seamless tracking and movement', impact: '99% accuracy' }
                        ],
                        custom: [
                            { name: 'Process Standardization', description: 'Consistent execution every time', impact: '100% compliance' },
                            { name: 'Data-Driven Insights', description: 'Analytics and performance metrics', impact: 'Continuous improvement' },
                            { name: 'Scalable Operations', description: 'Handle increased volume without staff', impact: 'Linear cost scaling' },
                            { name: 'Integration Capabilities', description: 'Connect with existing systems', impact: 'Unified operations' }
                        ]
                    };
                    
                    return benefits[processType] || benefits.custom;
                },

                getRecommendedTools(processType) {
                    const tools = {
                        data_entry: [
                            { name: 'Power Apps', icon: 'üì±', description: 'Custom forms with validation rules', features: ['Canvas Apps', 'Model-driven Apps', 'Data validation'] },
                            { name: 'Power Automate', icon: '‚ö°', description: 'Automated data flows between systems', features: ['Cloud flows', 'Data transformations', 'Error handling'] },
                            { name: 'AI Builder', icon: 'üß†', description: 'Document intelligence and OCR', features: ['Form processing', 'Text extraction', 'Document AI'] }
                        ],
                        approvals: [
                            { name: 'Power Automate', icon: '‚ö°', description: 'Workflow automation with approval steps', features: ['Approval flows', 'Conditional routing', 'Escalations'] },
                            { name: 'Power Apps', icon: 'üì±', description: 'Mobile approval applications', features: ['Mobile-first design', 'Offline capability', 'Rich media'] },
                            { name: 'Power BI', icon: 'üìä', description: 'Approval analytics and reporting', features: ['Real-time dashboards', 'KPI tracking', 'Performance metrics'] }
                        ],
                        reporting: [
                            { name: 'Power BI', icon: 'üìä', description: 'Interactive business intelligence', features: ['Real-time dashboards', 'Self-service analytics', 'Mobile reports'] },
                            { name: 'Power Automate', icon: '‚ö°', description: 'Automated report generation and distribution', features: ['Scheduled reports', 'Data refresh', 'Email delivery'] },
                            { name: 'Dataverse', icon: 'üóÑÔ∏è', description: 'Centralized data storage and modeling', features: ['Data integration', 'Relationships', 'Security'] }
                        ],
                        customer_service: [
                            { name: 'Power Virtual Agents', icon: 'ü§ñ', description: 'AI-powered customer service bots', features: ['Natural language', 'Multi-channel', 'Escalation'] },
                            { name: 'Power Apps', icon: 'üì±', description: 'Customer service portals and apps', features: ['Self-service', 'Case management', 'Knowledge base'] },
                            { name: 'Power Automate', icon: '‚ö°', description: 'Case routing and follow-up automation', features: ['Smart routing', 'SLA management', 'Notifications'] }
                        ],
                        hr_onboarding: [
                            { name: 'Power Apps', icon: 'üì±', description: 'Digital onboarding applications', features: ['Document collection', 'E-signatures', 'Progress tracking'] },
                            { name: 'Power Automate', icon: '‚ö°', description: 'HR process automation', features: ['Account provisioning', 'Task assignments', 'Notifications'] },
                            { name: 'AI Builder', icon: 'üß†', description: 'Document processing and verification', features: ['ID verification', 'Form processing', 'Compliance checks'] }
                        ],
                        invoice_processing: [
                            { name: 'AI Builder', icon: 'üß†', description: 'Invoice data extraction and processing', features: ['OCR', 'Data extraction', 'Validation'] },
                            { name: 'Power Automate', icon: '‚ö°', description: 'End-to-end invoice workflow', features: ['Three-way matching', 'Approval routing', 'ERP integration'] },
                            { name: 'Power BI', icon: 'üìä', description: 'Invoice analytics and reporting', features: ['Spend analysis', 'Vendor performance', 'Cash flow'] }
                        ],
                        inventory_management: [
                            { name: 'Power Apps', icon: 'üì±', description: 'Inventory management applications', features: ['Barcode scanning', 'Real-time updates', 'Mobile access'] },
                            { name: 'Power Automate', icon: '‚ö°', description: 'Automated inventory workflows', features: ['Reorder automation', 'Alerts', 'Supplier integration'] },
                            { name: 'Power BI', icon: 'üìä', description: 'Inventory analytics and forecasting', features: ['Demand planning', 'Stock optimization', 'Trend analysis'] }
                        ],
                        custom: [
                            { name: 'Power Platform Suite', icon: 'üîß', description: 'Complete low-code solution', features: ['Apps', 'Automation', 'Analytics', 'AI'] },
                            { name: 'Process Mining', icon: '‚õèÔ∏è', description: 'Process discovery and optimization', features: ['Process mapping', 'Bottleneck analysis', 'Optimization'] },
                            { name: 'Task Mining', icon: 'üëÅÔ∏è', description: 'Desktop task analysis', features: ['User recording', 'Pattern recognition', 'RPA opportunities'] }
                        ]
                    };
                    
                    return tools[processType] || tools.custom;
                },

                // Task Automation properties and data
                automationFilters: {
                    department: ''
                },
                selectedTasks: [],

                automationDepartments: {
                    admin: { 
                        name: 'Admin & HR', 
                        icon: 'üíº', 
                        color: '#0078D4',
                        description: 'Employee management and administrative workflows'
                    },
                    finance: { 
                        name: 'Finance & Procurement', 
                        icon: 'üßæ', 
                        color: '#107C10',
                        description: 'Financial processes and vendor management'
                    },
                    it: { 
                        name: 'IT & Helpdesk', 
                        icon: 'üßë‚Äçüíª', 
                        color: '#8661C5',
                        description: 'Technical support and infrastructure management'
                    },
                    marketing: { 
                        name: 'Marketing & Sales', 
                        icon: 'üì£', 
                        color: '#D13438',
                        description: 'Customer engagement and revenue operations'
                    },
                    operations: { 
                        name: 'Project & Operations', 
                        icon: 'üõ†Ô∏è', 
                        color: '#FF8C00',
                        description: 'Project management and operational workflows'
                    }
                },

                automationTasks: {
                    admin: [
                        {
                            id: 'admin_1',
                            manual: 'Sending follow-up or reminder emails',
                            automated: 'Scheduled or conditional reminder flows',
                            tools: ['Power Automate', 'Outlook'],
                            benefits: ['Saves time', 'Ensures consistency', 'Never miss follow-ups'],
                            steps: ['Create automated flow', 'Set conditions', 'Deploy and monitor']
                        },
                        {
                            id: 'admin_2',
                            manual: 'Collecting employee or client feedback via email',
                            automated: 'Online form with automated collection',
                            tools: ['Microsoft Forms', 'Power Automate'],
                            benefits: ['Streamlined data capture', 'Real-time responses', 'Automated analysis'],
                            steps: ['Design feedback form', 'Set up collection flow', 'Create reporting dashboard']
                        },
                        {
                            id: 'admin_3',
                            manual: 'Entering form data into Excel manually',
                            automated: 'Auto-saving form responses to Excel or Dataverse',
                            tools: ['Power Automate', 'Microsoft Forms', 'Excel'],
                            benefits: ['Reduces errors', 'Saves time', 'Real-time data updates'],
                            steps: ['Connect forms to database', 'Map data fields', 'Test automation']
                        },
                        {
                            id: 'admin_4',
                            manual: 'Employee onboarding tasks',
                            automated: 'Automated onboarding templates',
                            tools: ['Power Automate', 'Power Apps', 'Teams'],
                            benefits: ['Ensures consistency', 'Saves time', 'Better employee experience'],
                            steps: ['Design onboarding workflow', 'Create task templates', 'Integrate with HR systems']
                        },
                        {
                            id: 'admin_5',
                            manual: 'Manually updating employee records in Workday/ADP',
                            automated: 'Automated HR system synchronization',
                            tools: ['Power Automate', 'Workday Connector', 'Power Apps'],
                            benefits: ['Eliminates double data entry', 'Ensures data consistency', 'Real-time updates'],
                            steps: ['Configure HR connectors', 'Map data fields', 'Set up approval workflows']
                        },
                        {
                            id: 'admin_6',
                            manual: 'Creating and sending surveys via SurveyMonkey',
                            automated: 'Automated survey distribution and analysis',
                            tools: ['Power Automate', 'SurveyMonkey', 'Power BI'],
                            benefits: ['Automated distribution', 'Real-time analytics', 'Better response rates'],
                            steps: ['Connect SurveyMonkey', 'Set up triggers', 'Create analytics dashboard']
                        },
                        {
                            id: 'admin_7',
                            manual: 'Managing files between Dropbox and SharePoint',
                            automated: 'Automated file synchronization',
                            tools: ['Power Automate', 'Dropbox', 'SharePoint'],
                            benefits: ['Automatic sync', 'Version control', 'Access from anywhere'],
                            steps: ['Configure file connectors', 'Set sync rules', 'Test file transfers']
                        }
                    ],
                    finance: [
                        {
                            id: 'finance_1',
                            manual: 'Getting approvals via email threads',
                            automated: 'Automated multi-level approval workflows',
                            tools: ['Power Automate', 'Teams', 'SharePoint'],
                            benefits: ['Tracks status', 'Escalates when needed', 'Audit trail'],
                            steps: ['Define approval hierarchy', 'Create approval flow', 'Set up notifications']
                        },
                        {
                            id: 'finance_2',
                            manual: 'Emailing invoices manually',
                            automated: 'Auto-generation and email of invoices',
                            tools: ['Power Automate', 'Excel', 'AI Builder'],
                            benefits: ['Faster delivery', 'Standardized format', 'Reduced errors'],
                            steps: ['Create invoice template', 'Set up generation flow', 'Automate delivery']
                        },
                        {
                            id: 'finance_3',
                            manual: 'Manual invoice processing',
                            automated: 'AI-powered invoice data extraction',
                            tools: ['AI Builder', 'Power Automate', 'Power BI'],
                            benefits: ['85% time savings', '90% accuracy', 'Faster approvals'],
                            steps: ['Train AI model', 'Create processing flow', 'Set up reporting']
                        },
                        {
                            id: 'finance_4',
                            manual: 'Budget tracking in spreadsheets',
                            automated: 'Real-time budget dashboards',
                            tools: ['Power BI', 'Excel', 'Power Automate'],
                            benefits: ['Real-time insights', 'Automated alerts', 'Better decisions'],
                            steps: ['Connect data sources', 'Create dashboard', 'Set up alerts']
                        },
                        {
                            id: 'finance_5',
                            manual: 'Manually syncing Xero/QuickBooks data with Excel',
                            automated: 'Automated accounting system integration',
                            tools: ['Power Automate', 'Xero Connector', 'QuickBooks', 'Excel'],
                            benefits: ['Real-time financial data', 'Eliminates manual reconciliation', 'Reduces errors'],
                            steps: ['Connect Xero/QuickBooks API', 'Map data fields', 'Schedule sync intervals']
                        },
                        {
                            id: 'finance_6',
                            manual: 'Processing payments through Stripe/PayPal manually',
                            automated: 'Automated payment processing and reconciliation',
                            tools: ['Power Automate', 'Stripe', 'PayPal', 'Power BI'],
                            benefits: ['Instant payment confirmations', 'Automated reconciliation', 'Real-time reporting'],
                            steps: ['Configure payment connectors', 'Set up webhook triggers', 'Create reconciliation flows']
                        },
                        {
                            id: 'finance_7',
                            manual: 'Manually generating expense reports from receipts',
                            automated: 'AI-powered expense processing from receipt photos',
                            tools: ['AI Builder', 'Power Apps', 'Power Automate'],
                            benefits: ['OCR receipt scanning', 'Automatic categorization', 'Policy compliance checks'],
                            steps: ['Train receipt recognition model', 'Build expense app', 'Create approval workflow']
                        },
                        {
                            id: 'finance_8',
                            manual: 'Manual SAP transaction posting and reporting',
                            automated: 'Automated SAP integration and reporting',
                            tools: ['Power Automate', 'SAP Connector', 'Power BI'],
                            benefits: ['Real-time SAP data', 'Automated posting', 'Live dashboards'],
                            steps: ['Configure SAP connector', 'Map transaction flows', 'Build real-time reports']
                        },
                        {
                            id: 'finance_9',
                            manual: 'Creating vendor invoices in Salesforce manually',
                            automated: 'Automated Salesforce invoice generation',
                            tools: ['Power Automate', 'Salesforce', 'AI Builder'],
                            benefits: ['Automated invoice creation', 'Data consistency', 'Faster processing'],
                            steps: ['Connect Salesforce', 'Create invoice templates', 'Set up trigger workflows']
                        }
                    ],
                    it: [
                        {
                            id: 'it_1',
                            manual: 'Responding to repetitive customer questions',
                            automated: 'FAQ bots or AI chatbots',
                            tools: ['Copilot Studio', 'Power Virtual Agents'],
                            benefits: ['Saves support team time', '24/7 availability', 'Consistent responses'],
                            steps: ['Create knowledge base', 'Train chatbot', 'Deploy to channels']
                        },
                        {
                            id: 'it_2',
                            manual: 'Requesting access to systems/documents',
                            automated: 'Self-service access request with approval flow',
                            tools: ['Power Automate', 'SharePoint', 'Power Apps'],
                            benefits: ['Controlled access', 'Auditable trail', 'Faster provisioning'],
                            steps: ['Create request form', 'Set up approval flow', 'Integrate with AD']
                        },
                        {
                            id: 'it_3',
                            manual: 'Manual ticket logging',
                            automated: 'Automated ticket creation and routing',
                            tools: ['Power Apps', 'Power Automate', 'Teams'],
                            benefits: ['Faster response', 'Better tracking', 'SLA compliance'],
                            steps: ['Create ticket form', 'Set up routing rules', 'Integrate systems']
                        },
                        {
                            id: 'it_4',
                            manual: 'Moving data between systems manually',
                            automated: 'Scheduled or triggered integration flows',
                            tools: ['Power Automate', 'Logic Apps', 'Azure'],
                            benefits: ['Ensures accuracy', 'Reduces workload', 'Real-time sync'],
                            steps: ['Map data flows', 'Create integration', 'Schedule updates']
                        },
                        {
                            id: 'it_5',
                            manual: 'Manually managing ServiceNow tickets and updates',
                            automated: 'Automated ServiceNow integration with workflows',
                            tools: ['Power Automate', 'ServiceNow', 'Power BI'],
                            benefits: ['Real-time ticket updates', 'Automated escalation', 'Better SLA tracking'],
                            steps: ['Connect ServiceNow API', 'Create ticket workflows', 'Set up dashboards']
                        },
                        {
                            id: 'it_6',
                            manual: 'Manual Jira issue tracking and project updates',
                            automated: 'Automated Jira integration and reporting',
                            tools: ['Power Automate', 'Jira', 'Azure DevOps'],
                            benefits: ['Synchronized project data', 'Automated notifications', 'Real-time reporting'],
                            steps: ['Configure Jira connector', 'Map workflow states', 'Create automation rules']
                        },
                        {
                            id: 'it_7',
                            manual: 'Sending notifications via Slack manually',
                            automated: 'Automated Slack notifications and alerts',
                            tools: ['Power Automate', 'Slack', 'Teams'],
                            benefits: ['Instant notifications', 'Multi-channel alerts', 'Better team communication'],
                            steps: ['Set up Slack connector', 'Create notification triggers', 'Configure message templates']
                        },
                        {
                            id: 'it_8',
                            manual: 'Manual GitHub repository management',
                            automated: 'Automated GitHub workflows and deployments',
                            tools: ['Power Automate', 'GitHub', 'Azure DevOps'],
                            benefits: ['Automated deployments', 'Code review workflows', 'CI/CD integration'],
                            steps: ['Connect GitHub repository', 'Set up automation triggers', 'Configure deployment pipelines']
                        },
                        {
                            id: 'it_9',
                            manual: 'Managing Zendesk tickets manually',
                            automated: 'Automated Zendesk ticket management',
                            tools: ['Power Automate', 'Zendesk', 'Power BI'],
                            benefits: ['Automated ticket routing', 'SLA monitoring', 'Customer satisfaction tracking'],
                            steps: ['Connect Zendesk API', 'Create ticket workflows', 'Build performance dashboards']
                        }
                    ],
                    marketing: [
                        {
                            id: 'marketing_1',
                            manual: 'Tracking project tasks in Excel',
                            automated: 'Digital Kanban board with task notifications',
                            tools: ['Microsoft Planner', 'Power Automate', 'Teams'],
                            benefits: ['Visual management', 'Real-time updates', 'Better collaboration'],
                            steps: ['Set up project boards', 'Create notification rules', 'Train team']
                        },
                        {
                            id: 'marketing_2',
                            manual: 'Distributing announcements manually',
                            automated: 'Auto-post to Teams or email groups',
                            tools: ['Power Automate', 'Outlook', 'Teams'],
                            benefits: ['Consistent communication', 'Saves time', 'Better reach'],
                            steps: ['Create distribution lists', 'Set up posting flow', 'Schedule delivery']
                        },
                        {
                            id: 'marketing_3',
                            manual: 'Lead capture and follow-up',
                            automated: 'Automated lead processing and nurturing',
                            tools: ['Microsoft Forms', 'Power Automate', 'Power BI'],
                            benefits: ['Faster response', 'Never miss leads', 'Better conversion'],
                            steps: ['Create lead forms', 'Set up nurturing flow', 'Track performance']
                        },
                        {
                            id: 'marketing_4',
                            manual: 'Campaign performance tracking',
                            automated: 'Real-time marketing dashboards',
                            tools: ['Power BI', 'Power Automate', 'Excel'],
                            benefits: ['Real-time insights', 'Better optimization', 'ROI tracking'],
                            steps: ['Connect data sources', 'Create dashboards', 'Set up alerts']
                        },
                        {
                            id: 'marketing_5',
                            manual: 'Managing HubSpot contacts and deals manually',
                            automated: 'Automated HubSpot CRM synchronization',
                            tools: ['Power Automate', 'HubSpot', 'Power BI'],
                            benefits: ['Real-time contact updates', 'Automated deal progression', 'Better sales insights'],
                            steps: ['Connect HubSpot API', 'Set up contact sync', 'Create sales dashboards']
                        },
                        {
                            id: 'marketing_6',
                            manual: 'Creating and sending Mailchimp campaigns manually',
                            automated: 'Automated email marketing campaigns',
                            tools: ['Power Automate', 'Mailchimp', 'Microsoft Forms'],
                            benefits: ['Triggered campaigns', 'Better segmentation', 'Improved open rates'],
                            steps: ['Connect Mailchimp API', 'Set up triggers', 'Create audience segments']
                        },
                        {
                            id: 'marketing_7',
                            manual: 'Posting to social media manually',
                            automated: 'Automated social media publishing',
                            tools: ['Power Automate', 'Twitter', 'LinkedIn'],
                            benefits: ['Consistent posting schedule', 'Multi-platform publishing', 'Better engagement'],
                            steps: ['Connect social platforms', 'Create content calendar', 'Set up scheduling']
                        },
                        {
                            id: 'marketing_8',
                            manual: 'Tracking Google Analytics data in spreadsheets',
                            automated: 'Automated Google Analytics reporting',
                            tools: ['Power Automate', 'Google Analytics', 'Power BI'],
                            benefits: ['Real-time website metrics', 'Automated reporting', 'Better insights'],
                            steps: ['Connect Google Analytics API', 'Set up data flows', 'Create analytics dashboards']
                        },
                        {
                            id: 'marketing_9',
                            manual: 'Managing Salesforce leads and opportunities',
                            automated: 'Automated Salesforce CRM workflows',
                            tools: ['Power Automate', 'Salesforce', 'Power Apps'],
                            benefits: ['Automated lead scoring', 'Pipeline management', 'Better forecasting'],
                            steps: ['Connect Salesforce', 'Create lead workflows', 'Set up opportunity tracking']
                        }
                    ],
                    operations: [
                        {
                            id: 'operations_1',
                            manual: 'Generating weekly status reports',
                            automated: 'Auto-generated dashboards and summaries',
                            tools: ['Power BI', 'Excel', 'Power Query'],
                            benefits: ['Real-time insights', 'Reduced manual work', 'Consistent format'],
                            steps: ['Connect data sources', 'Create templates', 'Schedule delivery']
                        },
                        {
                            id: 'operations_2',
                            manual: 'Scheduling meetings manually',
                            automated: 'Online booking and availability sync',
                            tools: ['Microsoft Bookings', 'Outlook', 'Power Automate'],
                            benefits: ['Less back-and-forth', 'Better scheduling', 'Automated reminders'],
                            steps: ['Set up booking page', 'Configure availability', 'Enable notifications']
                        },
                        {
                            id: 'operations_3',
                            manual: 'Manual workflow approvals',
                            automated: 'Structured approval flows',
                            tools: ['Power Automate', 'SharePoint', 'Teams'],
                            benefits: ['Reduces bottlenecks', 'Clear visibility', 'Faster processing'],
                            steps: ['Map approval process', 'Create workflow', 'Set up escalations']
                        },
                        {
                            id: 'operations_4',
                            manual: 'Reporting issues via email',
                            automated: 'Form or app to submit issues',
                            tools: ['Power Apps', 'SharePoint', 'Power BI'],
                            benefits: ['Tracks and manages issues', 'Better visibility', 'Faster resolution'],
                            steps: ['Create issue form', 'Set up tracking', 'Build dashboard']
                        },
                        {
                            id: 'operations_5',
                            manual: 'Managing project tasks in Asana/Monday.com manually',
                            automated: 'Automated project management integration',
                            tools: ['Power Automate', 'Asana', 'Monday.com', 'Power BI'],
                            benefits: ['Synchronized project data', 'Automated progress tracking', 'Real-time reporting'],
                            steps: ['Connect project management API', 'Set up task sync', 'Create progress dashboards']
                        },
                        {
                            id: 'operations_6',
                            manual: 'Sending contracts for DocuSign manually',
                            automated: 'Automated document signing workflows',
                            tools: ['Power Automate', 'DocuSign', 'SharePoint'],
                            benefits: ['Faster contract execution', 'Automated reminders', 'Better tracking'],
                            steps: ['Connect DocuSign API', 'Create signing workflows', 'Set up status tracking']
                        },
                        {
                            id: 'operations_7',
                            manual: 'Manual FTP file transfers and monitoring',
                            automated: 'Automated file transfer and processing',
                            tools: ['Power Automate', 'Logic Apps', 'Azure'],
                            benefits: ['Scheduled transfers', 'Error handling', 'Automated processing'],
                            steps: ['Configure FTP connectors', 'Set up transfer schedules', 'Create monitoring alerts']
                        },
                        {
                            id: 'operations_8',
                            manual: 'Manual SQL database queries and reports',
                            automated: 'Automated database reporting and alerts',
                            tools: ['Power Automate', 'SQL Server', 'Power BI'],
                            benefits: ['Real-time data access', 'Automated reports', 'Proactive alerts'],
                            steps: ['Connect SQL database', 'Create query templates', 'Set up automated reporting']
                        },
                        {
                            id: 'operations_9',
                            manual: 'Manual REST API calls and data processing',
                            automated: 'Automated API integration and data flows',
                            tools: ['Power Automate', 'Logic Apps', 'Power BI'],
                            benefits: ['Real-time data synchronization', 'Error handling', 'Scalable processing'],
                            steps: ['Configure API connectors', 'Create data transformation flows', 'Set up monitoring']
                        }
                    ]
                },

                getFilteredAutomationTasks() {
                    if (this.automationFilters.department) {
                        return { [this.automationFilters.department]: this.automationTasks[this.automationFilters.department] };
                    }
                    return this.automationTasks;
                },

                selectAllVisibleTasks() {
                    const filteredTasks = this.getFilteredAutomationTasks();
                    const allTaskIds = [];
                    
                    Object.values(filteredTasks).forEach(taskList => {
                        taskList.forEach(task => {
                            if (!this.selectedTasks.includes(task.id)) {
                                allTaskIds.push(task.id);
                            }
                        });
                    });
                    
                    this.selectedTasks = [...this.selectedTasks, ...allTaskIds];
                },

                getTaskById(taskId) {
                    for (const department in this.automationTasks) {
                        const task = this.automationTasks[department].find(t => t.id === taskId);
                        if (task) return task;
                    }
                    return null;
                },

                getUniqueTools() {
                    const tools = new Set();
                    this.selectedTasks.forEach(taskId => {
                        const task = this.getTaskById(taskId);
                        if (task) {
                            task.tools.forEach(tool => tools.add(tool));
                        }
                    });
                    return Array.from(tools);
                },

                getToolIcon(tool) {
                    const icons = {
                        'Power Apps': 'üì±',
                        'Power Automate': '‚ö°',
                        'Power BI': 'üìä',
                        'Microsoft Forms': 'üìù',
                        'SharePoint': 'üóÇÔ∏è',
                        'Teams': 'üë•',
                        'Outlook': 'üìß',
                        'Excel': 'üìà',
                        'AI Builder': 'üß†',
                        'Copilot Studio': 'ü§ñ',
                        'Power Virtual Agents': 'ü§ñ',
                        'Microsoft Planner': 'üìã',
                        'Microsoft Bookings': 'üìÖ',
                        'Azure DevOps': 'üîß',
                        'Logic Apps': '‚öôÔ∏è',
                        'Azure': '‚òÅÔ∏è'
                    };
                    return icons[tool] || 'üõ†Ô∏è';
                },

                getToolDescription(tool) {
                    const descriptions = {
                        'Power Apps': 'Low-code app development platform',
                        'Power Automate': 'Workflow automation and RPA',
                        'Power BI': 'Business intelligence and analytics',
                        'Microsoft Forms': 'Survey and form builder',
                        'SharePoint': 'Document management and collaboration',
                        'Teams': 'Chat, meetings, and collaboration',
                        'Outlook': 'Email and calendar management',
                        'Excel': 'Spreadsheet and data analysis',
                        'AI Builder': 'AI capabilities for automation',
                        'Copilot Studio': 'Conversational AI platform',
                        'Power Virtual Agents': 'Chatbot development',
                        'Microsoft Planner': 'Task and project management',
                        'Microsoft Bookings': 'Appointment scheduling',
                        'Azure DevOps': 'Development and deployment',
                        'Logic Apps': 'Enterprise integration',
                        'Azure': 'Cloud computing platform'
                    };
                    return descriptions[tool] || 'Microsoft productivity tool';
                },

                getPhaseOneTasks() {
                    // Quick wins that can be implemented in first 2 weeks
                    const quickTasks = this.selectedTasks.slice(0, 3).map(taskId => {
                        const task = this.getTaskById(taskId);
                        return task ? task.manual.substring(0, 30) + '...' : '';
                    }).filter(Boolean);
                    
                    if (quickTasks.length === 0) {
                        return ['Forms automation', 'Email workflows', 'Basic approvals'];
                    }
                    return quickTasks;
                },

                getPhaseTwoTasks() {
                    // Medium complexity tasks for weeks 3-6
                    const mediumTasks = this.selectedTasks.slice(3, 6).map(taskId => {
                        const task = this.getTaskById(taskId);
                        return task ? task.manual.substring(0, 30) + '...' : '';
                    }).filter(Boolean);
                    
                    if (mediumTasks.length === 0) {
                        return ['Custom apps', 'Advanced workflows', 'Integration flows'];
                    }
                    return mediumTasks;
                },

                getPhaseThreeTasks() {
                    // Complex tasks for weeks 7-12
                    const complexTasks = this.selectedTasks.slice(6, 9).map(taskId => {
                        const task = this.getTaskById(taskId);
                        return task ? task.manual.substring(0, 30) + '...' : '';
                    }).filter(Boolean);
                    
                    if (complexTasks.length === 0) {
                        return ['AI implementation', 'Process mining', 'Advanced analytics'];
                    }
                    return complexTasks;
                },

                calculateImplementationCost() {
                    const toolCounts = {};
                    const licensedTools = new Set();
                    
                    this.selectedTasks.forEach(taskId => {
                        const task = this.getTaskById(taskId);
                        if (task) {
                            task.tools.forEach(tool => {
                                toolCounts[tool] = (toolCounts[tool] || 0) + 1;
                                // Add tools that require licensing
                                if (['Power Apps', 'Power Automate', 'Power BI', 'AI Builder', 'Copilot Studio', 'Microsoft Bookings', 'Azure DevOps', 'SharePoint', 'Logic Apps', 'Azure'].includes(tool)) {
                                    licensedTools.add(tool);
                                }
                            });
                        }
                    });

                    const toolPricing = {
                        'Power Apps': { cost: 20, description: 'Power Apps Premium (per user/month)' },
                        'Power Automate': { cost: 15, description: 'Power Automate Premium (per user/month)' },
                        'Power BI': { cost: 10, description: 'Power BI Pro (per user/month)' },
                        'AI Builder': { cost: 500, description: 'AI Builder Credits (1M credits/month)' },
                        'Copilot Studio': { cost: 200, description: 'Copilot Studio (10k sessions/month)' },
                        'Microsoft Bookings': { cost: 25, description: 'Microsoft Bookings SMS + Premium Features (per month)' },
                        'Azure DevOps': { cost: 6, description: 'Azure DevOps Basic (per user/month)' },
                        'SharePoint': { cost: 5, description: 'SharePoint Online Plan 2 (per user/month)' },
                        'Logic Apps': { cost: 100, description: 'Logic Apps Consumption (per month)' },
                        'Azure': { cost: 50, description: 'Azure Services (estimated/month)' }
                    };

                    let totalMonthlyCost = 0;
                    const licenseBreakdown = [];

                    licensedTools.forEach(tool => {
                        if (toolPricing[tool]) {
                            const toolCost = toolPricing[tool].cost;
                            totalMonthlyCost += toolCost;
                            licenseBreakdown.push({
                                tool: tool,
                                cost: toolCost,
                                description: toolPricing[tool].description,
                                usage: toolCounts[tool] || 1
                            });
                        }
                    });

                    // Calculate implementation hours based on task complexity
                    const baseHoursPerTask = 8; // 8 hours per basic task
                    const complexityMultiplier = this.getImplementationComplexity();
                    const totalImplementationHours = this.selectedTasks.length * baseHoursPerTask * complexityMultiplier;
                    
                    // Calculate testing and innovation hours
                    const testingHours = Math.ceil(totalImplementationHours * 0.3); // 30% for testing
                    const innovationHours = Math.ceil(totalImplementationHours * 0.2); // 20% for innovation/optimization

                    return {
                        monthly: totalMonthlyCost,
                        licenseBreakdown: licenseBreakdown,
                        implementationHours: totalImplementationHours,
                        testingHours: testingHours,
                        innovationHours: innovationHours,
                        totalProjectHours: totalImplementationHours + testingHours + innovationHours
                    };
                },

                getImplementationComplexity() {
                    const uniqueTools = this.getUniqueTools();
                    const toolCount = uniqueTools.length;
                    const taskCount = this.selectedTasks.length;
                    
                    // Complexity based on number of tools and tasks
                    if (toolCount <= 2 && taskCount <= 3) return 1.0; // Simple
                    if (toolCount <= 4 && taskCount <= 6) return 1.5; // Medium
                    if (toolCount <= 6 && taskCount <= 10) return 2.0; // Complex
                    return 2.5; // Very Complex
                },

                getProjectManagementPhases() {
                    const totalHours = this.calculateImplementationCost().totalProjectHours;
                    
                    return {
                        discovery: {
                            name: 'Discovery & Planning',
                            icon: 'üîç',
                            hours: Math.ceil(totalHours * 0.15),
                            activities: [
                                'Stakeholder interviews and requirements gathering',
                                'Current process documentation and gap analysis',
                                'Technical architecture planning',
                                'Risk assessment and mitigation strategies',
                                'Project charter and resource allocation'
                            ]
                        },
                        foundation: {
                            name: 'Foundation & Setup',
                            icon: 'üèóÔ∏è',
                            hours: Math.ceil(totalHours * 0.25),
                            activities: [
                                'Environment setup and security configuration',
                                'License provisioning and user access',
                                'Data sources and connector configuration',
                                'Core Power Platform infrastructure',
                                'Development standards and governance setup'
                            ]
                        },
                        development: {
                            name: 'Development & Integration',
                            icon: '‚ö°',
                            hours: Math.ceil(totalHours * 0.35),
                            activities: [
                                'Power Apps development and customization',
                                'Power Automate workflow creation',
                                'Power BI dashboard and report development',
                                'AI Builder model training and integration',
                                'Cross-platform integration and testing'
                            ]
                        },
                        testing: {
                            name: 'Testing & Quality Assurance',
                            icon: 'üß™',
                            hours: Math.ceil(totalHours * 0.15),
                            activities: [
                                'Unit testing and integration testing',
                                'User acceptance testing (UAT)',
                                'Performance and load testing',
                                'Security and compliance validation',
                                'Bug fixes and optimization'
                            ]
                        },
                        deployment: {
                            name: 'Deployment & Go-Live',
                            icon: 'üöÄ',
                            hours: Math.ceil(totalHours * 0.10),
                            activities: [
                                'Production deployment and monitoring',
                                'User training and change management',
                                'Go-live support and issue resolution',
                                'Knowledge transfer and documentation',
                                'Success metrics and KPI establishment'
                            ]
                        }
                    };
                },

                exportReport() {
                    const currentDate = new Date().toLocaleDateString();
                    const totalCost = this.calculateAdvancedLicenseCost();
                    const selectedProductCount = this.calculator.products.length;
                    
                    if (selectedProductCount === 0) {
                        alert('Please select at least one product in the Licensing & Pricing section before generating a report.');
                        return;
                    }
                    
                    // Generate product rows
                    let productRows = '';
                    for (const product of this.calculator.products) {
                        const productInfo = this.licensingData[product];
                        const users = this.calculator.productUsers[product] || 1;
                        const licenseType = this.calculator.productLicenseType[product] || 'premium';
                        const cost = this.getAdvancedProductCost(product);
                        
                        productRows += `
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-6 py-4 font-medium">
                                    <div class="flex items-center">
                                        <span class="text-2xl mr-3">${productInfo?.icon || ''}</span>
                                        <span>${productInfo?.name || product}</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4 text-center">${users.toLocaleString()}</td>
                                <td class="px-6 py-4 text-center">
                                    <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">${licenseType.replace('_', ' ')}</span>
                                </td>
                                <td class="px-6 py-4 text-center font-semibold">$${cost.toLocaleString()}</td>
                            </tr>
                        `;
                    }
                    
                    // Generate capabilities sections
                    let capabilitiesSection = '';
                    for (const product of this.calculator.products) {
                        const productInfo = this.licensingData[product];
                        const licenseType = this.calculator.productLicenseType[product] || 'premium';
                        const capabilities = this.getLicenseCapabilities(product, licenseType);
                        
                        capabilitiesSection += `
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 mb-6">
                                <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20">
                                    <div class="flex items-center">
                                        <span class="text-3xl mr-3">${productInfo?.icon || ''}</span>
                                        <div>
                                            <h3 class="text-xl font-bold">${productInfo?.name || product}</h3>
                                            <p class="text-gray-600 dark:text-gray-400">License: ${licenseType.replace('_', ' ')}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-6">
                                    <h4 class="font-semibold text-lg mb-4">Key Capabilities</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        ${capabilities.map(capability => `
                                            <div class="flex items-start space-x-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                                <div class="flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center">
                                                    <span class="text-green-600 text-xs">‚úì</span>
                                                </div>
                                                <span class="text-sm">${capability}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                    
                    // Create the complete HTML report
                    const reportHTML = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Platform Analysis Report - ${currentDate}</title>
    <script src="https://cdn.tailwindcss.com"><\/script>
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
    <\/script>
    <style>
        @media print {
            body { print-color-adjust: exact; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <header class="bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-xl">
        <div class="container mx-auto px-6 py-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 bg-white/10 backdrop-blur-sm rounded-xl flex items-center justify-center border border-white/20">
                        <span class="text-white font-bold text-2xl">PP</span>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold">Microsoft Power Platform</h1>
                        <p class="text-white/90 text-lg">Licensing & Cost Analysis Report</p>
                    </div>
                </div>
                <div class="text-right text-white/80">
                    <p class="text-sm">Generated: ${currentDate}</p>
                    <p class="text-sm">Power Platform Analysis Tool</p>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-6 py-8">
        <section class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 mb-8">
            <h2 class="text-2xl font-bold text-blue-600 mb-6">üìä Executive Summary</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl">
                    <h3 class="text-lg font-semibold mb-2">Selected Products</h3>
                    <p class="text-3xl font-bold text-blue-600">${selectedProductCount}</p>
                </div>
                <div class="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-6 rounded-xl">
                    <h3 class="text-lg font-semibold mb-2">Monthly Cost</h3>
                    <p class="text-3xl font-bold text-green-600">$${totalCost.toLocaleString()}</p>
                </div>
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-6 rounded-xl">
                    <h3 class="text-lg font-semibold mb-2">Annual Cost</h3>
                    <p class="text-3xl font-bold text-purple-600">$${(totalCost * 12).toLocaleString()}</p>
                </div>
            </div>
        </section>

        <section class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden mb-8">
            <div class="p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800">
                <h2 class="text-2xl font-bold text-blue-600">üí∞ Selected Products & Pricing</h2>
                <p class="text-gray-600 dark:text-gray-400 mt-2">Detailed breakdown of your Power Platform licensing configuration</p>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50 dark:bg-gray-700">
                        <tr>
                            <th class="px-6 py-4 text-left text-sm font-semibold">Product</th>
                            <th class="px-6 py-4 text-center text-sm font-semibold">Users</th>
                            <th class="px-6 py-4 text-center text-sm font-semibold">License Type</th>
                            <th class="px-6 py-4 text-center text-sm font-semibold">Monthly Cost</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                        ${productRows}
                        <tr class="bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold">
                            <td class="px-6 py-4 text-lg">TOTAL MONTHLY COST</td>
                            <td class="px-6 py-4"></td>
                            <td class="px-6 py-4"></td>
                            <td class="px-6 py-4 text-center text-xl">$${totalCost.toLocaleString()}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="mb-8">
            <h2 class="text-2xl font-bold text-blue-600 mb-6">üöÄ Product Capabilities & Features</h2>
            ${capabilitiesSection}
        </section>

        <section class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 text-center no-print">
            <h2 class="text-2xl font-bold text-blue-600 mb-4">üìã Next Steps</h2>
            <p class="text-gray-600 dark:text-gray-400 mb-6">Ready to move forward with your Power Platform implementation?</p>
            <div class="flex flex-wrap justify-center gap-4">
                <button onclick="window.print()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                    üñ®Ô∏è Print Report
                </button>
                <button onclick="window.close()" class="px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                    ‚úï Close Window
                </button>
            </div>
        </section>
    </main>

    <footer class="bg-gray-100 dark:bg-gray-800 mt-8 py-6 text-center">
        <p class="text-gray-600 dark:text-gray-400">
            Microsoft Power Platform Analysis Report ‚Ä¢ Generated ${currentDate}
        </p>
        <p class="text-sm text-gray-500 dark:text-gray-500 mt-2">
            Pricing based on Microsoft official rates as of January 2025 ‚Ä¢ Subject to change
        </p>
    </footer>
</body>
</html>`;
                    
                    // Open the report in a new window
                    const reportWindow = window.open('', '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');
                    if (reportWindow) {
                        reportWindow.document.write(reportHTML);
                        reportWindow.document.close();
                        reportWindow.focus();
                    } else {
                        alert('‚ö†Ô∏è Please allow pop-ups for this site to view the HTML report.');
                    }
                }
            }
        }
    </script>
</body>
</html>
